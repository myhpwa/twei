{"version":3,"sources":["Globals.tsx","models/Settings.tsx","models/TmpSettings.tsx","redux/reducers/index.tsx","redux/reducers/setReducer.tsx","redux/reducers/tmpSetReducer.tsx","pages/SettingsPage.tsx","Apis.ts","models/CarrierInvChk.ts","pages/EInvoiceListPage.tsx","components/ShareTextModal.tsx","pages/DetailPage.tsx","pages/WinningListPage.tsx","App.tsx","redux/store.tsx","serviceWorkerRegistration.ts","index.tsx","../node_modules/@ionic/core/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object","../node_modules/ionicons/dist/esm-es5 lazy /^/.//.*/.entry/.js$/ groupOptions: {} namespace object"],"names":["pwaUrl","process","tweiDb","log","fileName","a","dbOpenReq","indexedDB","open","Promise","ok","fail","onsuccess","ev","db","result","trans","transaction","req","objectStore","get","_ev","data","console","error","Error","stack","err","transWrite","reqWrite","put","onerror","delete","clearIndexedDB","clear","localStorage","consoleLog","bind","consoleError","isMacCatalyst","isPlatform","navigator","platform","Globals","storeFile","getLog","enableAppLog","Array","from","arguments","apply","disableAppLog","appSettings","fetchErrorContent","className","style","fontSize","paddingTop","href","target","logout","dispatch","type","key","val","updateApp","resolve","serviceWorker","getRegistrations","then","regs","all","map","reg","update","newReg","installing","waiting","hasUpdates","reduce","prev","curr","updateCssVars","settings","document","documentElement","cssText","uiFontSize","isTouchDevice","isStoreApps","getFileFromIndexedDB","saveFileToIndexedDB","removeFileFromIndexedDB","clearAppData","copyToClipboard","text","clipboard","writeText","Settings","version","hasAppLog","theme","cardNo","cardEncrypt","TmpSettings","fetchError","isLoadingData","qryWinningList","carrierInvChkDetailsExt","shareTextModal","show","combineReducers","state","action","newSettings","JSON","parse","getItem","body","classList","forEach","test","remove","toggle","setItem","stringify","Object","keys","length","defaultSettings","undefined","tmpSettings","newState","_SettingsPage","props","showFontLicense","showClearAlert","showToast","toastMessage","tabIndex","icon","barcode","slot","this","fill","shape","size","onClick","e","setState","shareSocial","PackageInfos","pwaVersion","window","location","origin","hidden","mainVersion","informationCircle","bug","checked","onIonChange","isChecked","detail","encodeURIComponent","userAgent","download","flexDirection","textAlign","settingsJsonUri","createElement","click","id","accept","display","onChange","file","files","item","fileText","updateData","getElementById","value","querySelector","cssClass","isOpen","backdropDismiss","onDidPresent","header","buttons","handler","colorPalette","interface","interfaceOptions","min","max","pin","snaps","helpCircle","onDidDismiss","message","duration","React","Component","SettingsPage","withIonLifeCycle","connect","speechRate","bookmarks","voiceURI","eInvUrl","axiosInstance","axios","create","baseURL","timeout","headers","lookupDate","date","Date","month","getMonth","invTerm","getFullYear","toString","padStart","post","qs","UUID","res","carrierInvChkDetailDate","invDate","year","invoiceTime","findMonthStartDateEndDate","d","endDate","startDate","getDate","isLogin","endPoint","now","Math","ceil","valueOf","dates","cardType","onlyWinningInv","uuid","timeStamp","expTimeStamp","code","msg","details","sort","b","invNum","WinningStatus","Apis","carrierInvChk","carrierInvDetail","winningStatusToString","status","Super","Special","First","Second","Third","Forth","Fifth","Sixth","SixthEx","NoAward","_EInvoiceListPage","page","rows","dataParts","dateSel","popover","event","isScrollOn","showConfrimSaveFormAlert","fetchDataAndShow","setIsLoading","fetchData","showDataPageByPage","res2","v","i","winningStatus","calculateInvoiceWinningStatus","fromStart","slice","substring","winningList","NotYet","firstPrizeNos","firstPrizeNo1","firstPrizeNo2","firstPrizeNo3","firstPrizeNo4","firstPrizeNo5","firstPrizeNo6","firstPrizeNo7","firstPrizeNo8","firstPrizeNo9","firstPrizeNo10","sixthPrizeNos","sixthPrizeNo1","sixthPrizeNo2","sixthPrizeNo3","sixthPrizeNo4","sixthPrizeNo5","sixthPrizeNo6","superPrizeNo","spcPrizeNo","spcPrizeNo2","spcPrizeNo3","some","no","index","row","button","history","push","amount","sellerName","displayFormat","doneText","cancelText","placeholder","getRows","threshold","disabled","onIonInfinite","complete","loadingText","EInvoiceListPage","_ShareTextModal","isAppSettingsExport","appSettingsString","filter","keyVal","join","appUrl","hasQueryString","qrcCanvas","qrcode","showModal","swipeToClose","onWillPresent","updateQrCode","finish","height","alignItems","flexGrow","flexShrink","margin","width","_DetailPage","match","params","replaceAll","cid","goBack","arrowBack","color","lines","sellerBan","sellerAddress","fontWeight","description","quantity","DetailPage","_WinningListPage","maxDate","currentDate","qwl","monthValues","monthShortNames","WinningListPage","electronBackendApi","store","savedSettingsStr","createStore","reducer","getSavedStore","setupConfig","mode","swipeBackEnabled","serviceWorkCallbacks","onSuccess","registration","onUpdate","_App","AppOrig","_AppOrig","registrationNew","originalAppSettingsStr","wakeLock","receive","send","queryParams","queryString","search","split","setting","showUpdateAlert","showRestoreAppSettingsToast","speechSynthesis","getVoices","cancel","wakeLockScreen","addEventListener","visibilityState","wakeLockScreenRelease","onupgradeneeded","createObjectStore","request","name","release","routeMatches","exec","queryMatches","route","decodeURIComponent","query","to","pathname","animated","path","render","exact","routeByQueryString","tab","receipt","trophy","postMessage","ShareTextModal","role","restoreAppSettings","App","withRouter","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","register","onupdatefound","installingWorker","onstatechange","controller","catch","ReactDOM","URL","fetch","response","contentType","indexOf","ready","unregister","reload","checkValidServiceWorker","webpackAsyncContext","__webpack_require__","o","ids","module","exports"],"mappings":"yXAEMA,EAASC,QAETC,EAAS,SACXC,EAAM,G,4CAgBV,WAAoCC,GAApC,eAAAC,EAAA,6DACQC,EAAYC,UAAUC,KAAKN,GADnC,kBAGS,IAAIO,SAAQ,SAAUC,EAAIC,GAC/BL,EAAUM,UAAV,uCAAsB,WAAgBC,GAAhB,mBAAAR,EAAA,sDACdS,EAAKR,EAAUS,OAErB,IACQC,EAAQF,EAAGG,YAAY,CAAC,SAAU,cACpCC,EAAMF,EAAMG,YAAY,SAASC,IAAIhB,IACrCQ,UAAJ,uCAAgB,WAAgBS,GAAhB,eAAAhB,EAAA,yDACRiB,EAAOJ,EAAIH,OADH,uBAGZQ,QAAQC,MAAR,UAAiBpB,EAAjB,qBACAmB,QAAQC,OAAM,IAAIC,OAAQC,OAJd,kBAKLf,KALK,gCAOPD,EAAGY,IAPI,2CAAhB,sDASA,MAAOK,GACPJ,QAAQC,MAAMG,GAhBI,2CAAtB,0DAJJ,4C,kEA0BA,WAAmCvB,EAAkBkB,GAArD,eAAAjB,EAAA,6DACQC,EAAYC,UAAUC,KAAKN,GADnC,kBAES,IAAIO,SAAc,SAACC,EAAIC,GAC5BL,EAAUM,UAAV,uCAAsB,WAAOC,GAAP,mBAAAR,EAAA,sDACdS,EAAKR,EAAUS,OAEfa,EAAad,EAAGG,YAAY,CAAC,SAAU,cACvCY,EAAWD,EAAWT,YAAY,SAASW,IAAIR,EAAMlB,IAClDQ,UAAY,SAACS,GAAD,OAAcX,KACnCmB,EAASE,QAAU,SAACV,GAAD,OAAcV,KANb,2CAAtB,0DAHJ,4C,kEAcA,WAAuCP,GAAvC,eAAAC,EAAA,6DACQC,EAAYC,UAAUC,KAAKN,GADnC,kBAES,IAAIO,SAAc,SAACC,EAAIC,GAC5B,IACEL,EAAUM,UAAY,SAACC,GACrB,IAEMe,EAFKtB,EAAUS,OAECE,YAAY,CAAC,SAAU,aAC7C,IACE,IAAMY,EAAWD,EAAWT,YAAY,SAASa,OAAO5B,GACxDyB,EAASjB,UAAY,SAACS,GAAD,OAAcX,KACnCmB,EAASE,QAAU,SAACV,GAAD,OAAcV,KACjC,MAAOgB,GACPJ,QAAQC,MAAMG,KAGlB,MAAOA,GACPhB,EAAKgB,QAjBX,4C,+BAsBeM,I,2EAAf,4BAAA5B,EAAA,6DACQC,EAAYC,UAAUC,KAAKN,GADnC,kBAES,IAAIO,SAAc,SAACC,EAAIC,GAC5BL,EAAUM,UAAV,uCAAsB,WAAOC,GAAP,mBAAAR,EAAA,sDACdS,EAAKR,EAAUS,OAEfa,EAAad,EAAGG,YAAY,CAAC,SAAU,cACvCY,EAAWD,EAAWT,YAAY,SAASe,SACxCtB,UAAY,SAACS,GAAD,OAAcX,KACnCmB,EAASE,QAAU,SAACV,GAAD,OAAcV,KANb,2CAAtB,0DAHJ,4C,kEAcA,sBAAAN,EAAA,6DACE8B,aAAaD,QADf,SAEQD,IAFR,4C,sBAOA,IAAMG,EAAab,QAAQpB,IAAIkC,KAAKd,SAC9Be,EAAef,QAAQC,MAAMa,KAAKd,SAmCxC,SAASgB,IACP,OAAOC,YAAW,QAAiC,aAAvBC,UAAUC,SAGxC,IAiDeC,EAjDC,CACd3C,SACA4C,UAAW,oBACXC,OAxCF,WACE,OAAO1C,GAwCP2C,aArCF,WACEvB,QAAQpB,IAAM,WACZA,GAAO,oBACPA,GAAQ4C,MAAMC,KAAKC,WAAc,KACjCb,EAAWc,MAAM3B,QAAS0B,YAG5B1B,QAAQC,MAAQ,WACdrB,GAAO,qBACPA,GAAQ4C,MAAMC,KAAKC,WAAc,KACjCX,EAAaY,MAAM3B,QAAS0B,aA4B9BE,cAxBF,WACEhD,EAAM,GACNoB,QAAQpB,IAAMiC,EACdb,QAAQC,MAAQc,GAsBhBpC,SACAkD,YAAa,CACX,MAAS,2BACT,WAAc,8BAEhBC,kBACE,qBAAKC,UAAU,gBAAf,SACE,cAAC,IAAD,UACE,gCACE,4DACA,sBAAKC,MAAO,CAAEC,SAAU,sBAAuBC,WAAY,IAA3D,qFAA6E,mBAAGC,KAAI,UAAK1D,EAAL,aAAwB2D,OAAO,QAAtC,gCAA7E,kEAKRC,OA9JF,SAAgBC,GACdA,EAAS,CACPC,KAAM,cACNC,IAAK,SACLC,IAAK,KAGPH,EAAS,CACPC,KAAM,cACNC,IAAK,cACLC,IAAK,MAqJPC,UAAW,WACT,OAAO,IAAIxD,QAAJ,uCAAY,WAAMyD,GAAN,SAAA7D,EAAA,sDACjBoC,UAAU0B,cAAcC,mBAAmBC,KAA3C,uCAAgD,WAAMC,GAAN,eAAAjE,EAAA,sEACrBI,QAAQ8D,IAAID,EAAKE,KAAI,SAAAC,GAAG,OAAKA,EAAIC,SAAiBL,MAAK,SAACM,GAC/E,OAA6B,OAAtBA,EAAOC,YAA0C,OAAnBD,EAAOE,eAFA,OACxCC,EADwC,OAI9CZ,EAAQY,EAAWC,QAAO,SAACC,EAAMC,GAAP,OAAgBD,GAAQC,KAAM,IAJV,2CAAhD,uDADiB,2CAAZ,wDASTC,cAAe,SAACC,GACdC,SAASC,gBAAgB9B,MAAM+B,QAA/B,0BAA4DH,EAASI,WAArE,QAEFhD,gBACAiD,cAAe,WACb,OAAQhD,YAAW,SAAWD,KAAoBC,YAAW,YAE/DiD,YAAa,WACX,OAAOjD,YAAW,QAAUA,YAAW,aAEzCkD,qB,4CACAC,oB,8CACAC,wB,4CACAC,a,2CACAC,gBA1DF,SAAyBC,GACvB,IACEtD,UAAUuD,WAAavD,UAAUuD,UAAUC,UAAUF,GACrD,MAAOvE,GACPD,QAAQC,MAAMA,MCxIL0E,EAAb,sCACIC,QAAkB,EADtB,KAEIC,WAAqB,EAFzB,KAGIC,MAAgB,EAHpB,KAIId,WAAqB,GAJzB,KAKIe,OAAiB,GALrB,KAMIC,YAAsB,ICHnB,IAAMC,EAAb,sCACIC,YAAsB,EAD1B,KAEIC,eAAyB,EAF7B,KAGIC,oBAHJ,OAIIC,wBAAoD,GAJxD,KAKIC,eAAiB,CAAEd,KAAM,GAAIe,MAAM,ICHxBC,kBAAgB,CAC7B5B,SCFa,WAAuD,IAAtC6B,EAAqC,uDAA7B,IAAId,EAAYe,EAAa,uCAC/DC,EAAW,eAAQF,GACvB,OAAQC,EAAOnD,MACb,IAAK,gBACHoD,EAAcC,KAAKC,MAAMjF,aAAakF,QAAQ1E,EAAQC,YAAauC,SACnE,MACF,IAAK,cACH,IAAIpB,EAAMkD,EAAOlD,IACbC,EAAMiD,EAAOjD,IACjB,OAAQD,GACN,IAAK,QACHqB,SAASkC,KAAKC,UAAUC,SAAQ,SAACxD,GAC3B,QAAQyD,KAAKzD,IACfoB,SAASkC,KAAKC,UAAUG,OAAO1D,MAGnCoB,SAASkC,KAAKC,UAAUI,OAAxB,eAAuC3D,IAAO,GAKjDkD,EAAoBnD,GAAOC,EAC5B7B,aAAayF,QAAQjF,EAAQC,UAAWuE,KAAKU,UAAU,CAAE1C,SAAU+B,KACnE,MAEF,IAAK,mBACHA,EAAc,IAAIhB,EAClB,MAEF,QAC0C,IAApC4B,OAAOC,KAAKb,GAAac,SAC3Bd,EAAc,IAAIhB,GAEpB,IAAM+B,EAAkB,IAAI/B,EAC5B4B,OAAOC,KAAKE,GAAiBT,SAAQ,SAAAzD,QACDmE,IAA7BhB,EAAoBnD,KACtBmD,EAAoBnD,GAAQkE,EAAwBlE,OAI7D,OAAOmD,GDtCGiB,YEHG,WAA0D,IAAzCnB,EAAwC,uDAAhC,IAAIR,EAAeS,EAAa,uCAClEmB,EAAQ,eAAQpB,GAChBjD,EAAMkD,EAAOlD,IACbC,EAAMiD,EAAOjD,IAEjB,OADCoE,EAAiBrE,GAAOC,EACjBiD,EAAOnD,MACb,IAAK,kBACH,OAAOsE,EAKX,OAAOpB,K,0GCoBHqB,E,kDACJ,WAAYC,GAAa,IAAD,8BACtB,cAAMA,IAEDtB,MAAQ,CACXuB,iBAAiB,EACjBC,gBAAgB,EAChBC,WAAW,EACXC,aAAc,IAPM,E,oDAWxB,c,+DAGA,sBAAArI,EAAA,0F,0EAGA,WAAU,IAAD,OACP,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,cAAC,IAAD,UACE,cAAC,IAAD,CAAUiD,UAAU,SAApB,8BAGJ,eAAC,IAAD,WACE,eAAC,IAAD,WACE,eAAC,IAAD,WACE,qBAAKqF,SAAU,IACf,cAAC,IAAD,CAASC,KAAMC,IAASC,KAAK,UAC7B,eAAC,IAAD,CAAUxF,UAAU,uBAApB,2CAAiDyF,KAAKT,MAAMnD,SAASmB,UACrE,cAAC,IAAD,CAAW0C,KAAK,UAAUC,MAAM,QAAQH,KAAK,MAAMI,KAAK,QAAQ5F,UAAU,SAAS6F,QAAS,SAAAC,GAC1FzG,EAAQiB,OAAO,EAAK0E,MAAMzE,UAC1B,EAAKwF,SAAS,CAACZ,WAAW,EAAMC,aAAc,oCAFhD,6BAKF,eAAC,IAAD,WACE,qBAAKC,SAAU,IACf,cAAC,IAAD,CAASC,KAAMU,IAAaR,KAAK,UACjC,eAAC,IAAD,CAAUxF,UAAU,uBAAuB6F,QAAO,uCAAE,WAAMC,GAAN,SAAA/I,EAAA,0FAAF,sDAAlD,+BAQW,mBAAGqD,KAAK,4CAA4CC,OAAO,OAA3D,SAAmE4F,EAAaC,gBAC3F,cAAC,IAAD,CAAWR,KAAK,UAAUC,MAAM,QAAQH,KAAK,MAAMI,KAAK,QAAQ5F,UAAU,SAAS6F,QAAS,SAAAC,GAC1F,EAAKd,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,iBACLC,IAAK,CACH8C,MAAM,EACNf,KAAM0D,OAAOC,SAASC,WAN5B,6BAWF,eAAC,IAAD,CAASC,QAASb,KAAKT,MAAMuB,YAA7B,UACE,qBAAKlB,SAAU,IACf,cAAC,IAAD,CAASC,KAAMkB,IAAmBhB,KAAK,UACvC,eAAC,IAAD,CAAUxF,UAAU,uBAApB,sCAA2DyF,KAAKT,MAAMuB,kBAIxE,eAAC,IAAD,WACE,qBAAKlB,SAAU,IACf,cAAC,IAAD,CAASC,KAAMmB,IAAKjB,KAAK,UACzB,cAAC,IAAD,CAAUxF,UAAU,uBAApB,SAA2C,mBAAGI,KAAK,2CAA2CC,OAAO,OAA1D,yDAC3C,cAAC,IAAD,CAAWmF,KAAK,MAAMkB,QAASjB,KAAKT,MAAMlC,UAAW6D,YAAa,SAAAb,GAChE,IAAMc,EAAYd,EAAEe,OAAOH,QAEvB,EAAK1B,MAAMlC,YAAc8D,IAI7BA,EAAYvH,EAAQG,eAAiBH,EAAQQ,gBAC7C,EAAKmF,MAAMzE,SAAS,CAClBC,KAAM,cACNC,IAAK,YACLC,IAAKkG,WAIX,eAAC,IAAD,CAASN,QAASb,KAAKT,MAAMlC,UAA7B,UACE,qBAAKuC,SAAU,IACf,cAAC,IAAD,CAASC,KAAMmB,IAAKjB,KAAK,UACzB,cAAC,IAAD,CAAUxF,UAAU,uBAApB,uDACA,cAAC,IAAD,CAAW0F,KAAK,UAAUC,MAAM,QAAQH,KAAK,MAAMI,KAAK,QAAQ5F,UAAU,SAAS6F,QAAS,SAAAC,GAC1FK,OAAOjJ,KAAP,wGAA2D4J,mBAAmB,uFAAwB3H,UAAU4H,UAAY,4BAAed,EAAaC,WAAa,4BAAerC,KAAKU,UAAU,EAAKS,MAAMnD,UAAY,kBAAexC,EAAQE,aADnP,6BAIF,eAAC,IAAD,WACE,qBAAK8F,SAAU,IACf,cAAC,IAAD,CAASC,KAAM0B,IAAUxB,KAAK,UAC9B,qBAAKxF,UAAU,eAAf,SACE,sBAAKC,MAAO,CAAEgH,cAAe,UAA7B,UACE,cAAC,IAAD,CAAUjH,UAAU,uBAApB,8BACA,sBAAKC,MAAO,CAAEiH,UAAW,SAAzB,UACE,cAAC,IAAD,CAAWxB,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQ5F,UAAU,SAAS6F,QAAO,uCAAE,WAAOC,GAAP,MAAA/I,EAAA,SAAAA,EAAA,sDACzEoK,EADyE,uCACvBL,mBAAmBjI,aAAakF,QAAQ1E,EAAQC,YAAc,MAChHvC,EAAI+E,SAASsF,cAAc,MAC/BhH,KAAO+G,EACTpK,EAAEiK,SAAW3H,EAAQC,UACrBvC,EAAEsK,QACFtK,EAAEqH,SAN6E,2CAAF,sDAA/E,0BAQA,uBAAOkD,GAAG,kBAAkB9G,KAAK,OAAO+G,OAAO,QAAQtH,MAAO,CAAEuH,QAAS,QAAUC,SAAQ,uCAAE,WAAOlK,GAAP,mBAAAR,EAAA,6DACrF2K,EADqF,UAC9EnK,EAAG8C,OAAOsH,aADoE,aAC9E,EAAiBC,KAAK,GADwD,gBAEpEF,QAFoE,IAEpEA,OAFoE,EAEpEA,EAAMjF,OAF8D,gDAEpD,GAFoD,OAErFoF,EAFqF,KAG3F,IAEEhE,KAAKC,MAAM+D,GACXhJ,aAAayF,QAAQjF,EAAQC,UAAWuI,GACxC,EAAK7C,MAAMzE,SAAS,CAAEC,KAAM,kBAC5B,EAAKsH,aACL,MAAOhC,GACP7H,QAAQC,MAAM4H,GACd7H,QAAQC,OAAM,IAAIC,OAAQC,OAE3B0D,SAASiG,eAAe,mBAAwCC,MAAQ,GAbkB,2CAAF,wDAgB3F,cAAC,IAAD,CAAWtC,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQ5F,UAAU,SAAS6F,QAAS,SAACC,GAC/EhE,SAASmG,cAAc,oBAAyCZ,SADnE,0BAGA,cAAC,IAAD,CAAW3B,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQ5F,UAAU,SAAS6F,QAAS,SAACC,GAChF,EAAKC,SAAS,CAAEb,gBAAgB,KADlC,0BAGA,cAAC,IAAD,CACEgD,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMwB,eACnBkD,iBAAiB,EACjBC,aAAc,SAAC9K,KAEf+K,OAAQ,wKACRC,QAAS,CACP,CACE9F,KAAM,eACNyF,SAAU,iBACVM,QAAS,SAACR,GACR,EAAKjC,SAAS,CACZb,gBAAgB,MAItB,CACEzC,KAAM,eACNyF,SAAU,mBACVM,QAAQ,WAAD,4BAAE,WAAOR,GAAP,SAAAjL,EAAA,sEACDsC,EAAQkD,eADP,OAGP,IADA,EAAKyC,MAAMzE,SAAS,CAAEC,KAAM,qBACrBsB,SAASkC,KAAKC,UAAUS,OAAS,GACtC5C,SAASkC,KAAKC,UAAUG,OAAOtC,SAASkC,KAAKC,UAAU2D,KAAK,IAE9D9F,SAASkC,KAAKC,UAAUI,OAAxB,eAAuC,EAAKW,MAAMjC,QAAS,GAC3D,EAAKgD,SAAS,CAAEb,gBAAgB,EAAOC,WAAW,EAAMC,aAAc,8BAP/D,2CAAF,mDAAC,kBAgBtB,eAAC,IAAD,WACE,qBAAKC,SAAU,IACf,cAAC,IAAD,CAASC,KAAMmD,IAAcjD,KAAK,UAClC,cAAC,IAAD,CAAUxF,UAAU,uBAApB,SAA4CX,EAAQS,YAAR,QAC5C,eAAC,IAAD,CAAW0F,KAAK,MACdwC,OAAQvC,KAAKT,MAAMjC,MACnB/C,UAAU,SACV0I,UAAU,UACVC,iBAAkB,CAAET,SAAU,cAC9BvB,YAAa,SAAAb,GACX,IAAMkC,GAASlC,EAAEe,OAAOmB,OAKnB,EAAKhD,MAAMjC,QAAUiF,GAI1B,EAAKhD,MAAMzE,SAAS,CAClBC,KAAM,cACNC,IAAK,QACLC,IAAKsH,KAlBX,UAqBE,cAAC,IAAD,CAAiBhI,UAAU,eAAegI,MAAO,EAAjD,0BACA,cAAC,IAAD,CAAiBhI,UAAU,cAAcgI,MAAO,EAAhD,0BACA,cAAC,IAAD,CAAiBhI,UAAU,eAAegI,MAAO,EAAjD,0BACA,cAAC,IAAD,CAAiBhI,UAAU,kBAAkBgI,MAAO,EAApD,0BACA,cAAC,IAAD,CAAiBhI,UAAU,gBAAgBgI,MAAO,EAAlD,sCAGJ,eAAC,IAAD,WACE,qBAAK3C,SAAU,IACf,cAAC,IAAD,CAASC,KAAM7C,IAAM+C,KAAK,UAC1B,qBAAKxF,UAAU,eAAf,SACE,sBAAKC,MAAO,CAAEgH,cAAe,UAA7B,UACE,eAAC,IAAD,CAAUjH,UAAU,uBAApB,UAA4CX,EAAQS,YAAR,WAA5C,KAAiF2F,KAAKT,MAAM/C,cAC5F,cAAC,IAAD,CAAU2G,IAAK,GAAIC,IAAK,GAAIC,KAAK,EAAMC,OAAO,EAAMf,MAAOvC,KAAKT,MAAM/C,WAAY0E,YAAa,SAAAb,GAC7F,EAAKd,MAAMzE,SAAS,CAClBC,KAAM,cACNC,IAAK,aACLC,IAAKoF,EAAEe,OAAOmB,QAEhB3I,EAAQuC,cAAc,EAAKoD,MAAMnD,qBAKzC,eAAC,IAAD,WACE,qBAAKwD,SAAU,IACf,cAAC,IAAD,CAASC,KAAM0D,IAAYxD,KAAK,UAChC,sBAAKxF,UAAU,SAAf,UACE,+CACA,8BAAK,mBAAGI,KAAK,4CAA4CC,OAAO,OAA3D,oDACL,8BAAK,mBAAGD,KAAK,oCAAoCC,OAAO,OAAnD,4EACL,gEACA,8BAAK,mBAAGD,KAAK,sBAAsBC,OAAO,OAArC,qCAKX,cAAC,IAAD,CACE6H,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMyB,UACnB8D,aAAc,kBAAM,EAAKlD,SAAS,CAAEZ,WAAW,KAC/C+D,QAASzD,KAAK/B,MAAM0B,aACpB+D,SAAU,gB,GA1OMC,IAAMC,WA+P5BC,EAAeC,YAAiBxE,GAEvByE,eAfS,SAAC9F,GACvB,MAAO,CACL7B,SAAU6B,EAAM7B,SAChBiB,UAAWY,EAAM7B,SAASiB,UAC1BC,MAAOW,EAAM7B,SAASkB,MACtBd,WAAYyB,EAAM7B,SAASI,WAC3BwH,WAAY/F,EAAM7B,SAAS4H,WAC3BC,UAAWhG,EAAM7B,SAAS6H,UAC1BC,SAAUjG,EAAM7B,SAAS8H,SACzBpD,YAAa7C,EAAMmB,YAAY0B,eAMpBiD,CAEbF,G,mDChSIM,EAAU,8DAEVC,EAAgBC,IAAMC,OAAO,CAC/BC,QAASJ,EACTK,QAAS,IACTC,QAAS,CACL,eAAgB,uC,4CAIxB,WAA8BC,GAA9B,qBAAApN,EAAA,6DACUqN,EAAO,IAAIC,KAAKF,GAChBG,EAAQF,EAAKG,WAAa,EAC1BC,GAAW,GAAD,OAAKJ,EAAKK,cAAgB,MAA1B,QAAoCH,EAAQ,IAAO,EAAIA,EAAQA,EAAQ,GAAGI,WAAWC,SAAS,EAAG,MAHrH,kBAK0Bd,EAAce,KAAd,UAAsBhB,EAAtB,kBAA+CiB,IAAGtG,UAAU,CAC1E1B,QAAS,GACTc,OAAQ,iBACR6G,QAASA,EACTM,KAAM,0CATlB,cAKcC,EALd,yBAWeA,EAAI/M,MAXnB,wG,sBAiBA,SAASgN,EAAwBnE,GAC7B,OAAO,IAAIwD,KAAJ,UAAYxD,EAAOoE,QAAQC,KAAO,KAAlC,YAA0CrE,EAAOoE,QAAQX,MAAzD,YAAkEzD,EAAOoE,QAAQb,KAAjF,YAAyFvD,EAAOsE,cAG3G,SAASC,GAA0BhB,GAC/B,IAAMiB,EAAI,IAAIhB,KAAKD,GACbkB,EAAU,IAAIjB,KAAKgB,EAAEZ,cAAeY,EAAEd,WAAa,EAAG,GAC5D,MAAO,CACHgB,UAAU,GAAD,OAAKF,EAAEZ,cAAP,aAAyBY,EAAEd,WAAa,GAAGG,WAAWC,SAAS,EAAG,KAAlE,OACTW,QAAQ,GAAD,OAAKD,EAAEZ,cAAP,aAAyBY,EAAEd,WAAa,GAAGG,WAAWC,SAAS,EAAG,KAAlE,YAA0EW,EAAQE,UAAUd,WAAWC,SAAS,EAAG,O,8CAIlI,WAA6B3H,EAAgBC,EAAqBkH,GAAlE,qCAAApN,EAAA,6DAAsF0O,EAAtF,yCAEcC,EAAWD,EAAU,cAAgB,mBACrCE,EAAMC,KAAKC,MAAM,IAAIxB,MAAQyB,UAAY,KACzCC,EAAQX,GAA0BjB,GAJhD,SAK0BN,EAAce,KAAd,UAAsBhB,GAAtB,OAAgC8B,GAAYb,IAAGtG,UAAU,CACvE1B,QAAS,GACTmJ,SAAU,SACVhJ,OAAQA,EACRW,OAAQ,gBACR4H,UAAWQ,EAAMR,UACjBD,QAASS,EAAMT,QACfW,eAAgB,IAChBC,KAAM,uCACNC,UAAWR,EAAM,GACjBS,aAAcT,EAAM,IACpB1I,YAAaA,KAhBzB,UAKc8H,EALd,QAkBYU,EAlBZ,uBAmBmB,IAAItN,MAAM,iBAnB7B,WAwB2B,QAFfH,EAAO+M,EAAI/M,MAELqO,KAxBlB,uBAyBiB,IAAIlO,MAAJ,UAAaH,EAAKqO,KAAlB,aAA2BrO,EAAKsO,MAzBjD,eA4BQtO,EAAKuO,QAAUvO,EAAKuO,QAAQC,MAAK,SAACzP,EAAG0P,GAAJ,OAAWzB,EAAwBjO,IAAMiO,EAAwByB,MA5B1G,kBA6BezO,GA7Bf,wG,oEAmCA,WAAgCgF,EAAgBC,EAAqByJ,EAAgBzB,GAArF,mBAAAlO,EAAA,sEAEc4O,EAAMC,KAAKC,MAAM,IAAIxB,MAAQyB,UAAY,KAFvD,SAG0BjC,EAAce,KAAd,UAAsBhB,EAAtB,oBAAiDiB,IAAGtG,UAAU,CAC5E1B,QAAS,GACTmJ,SAAU,SACVhJ,OAAQA,EACRW,OAAQ,mBACR+I,OAAQA,EACRzB,QAASA,EACTiB,KAAM,uCACNC,UAAWR,EAAM,GACjBS,aAAcT,EAAM,IACpB1I,YAAaA,KAbzB,cAGc8H,EAHd,OAec/M,EAAO+M,EAAI/M,KAfzB,kBAgBeA,GAhBf,qG,sBAsBA,IC/DY2O,GDqEGC,GANF,CACTvJ,e,4CACAwJ,c,iDACAC,iB,oDChDG,SAASC,GAAsBC,GAClC,OAAQA,GACJ,KAAKL,GAAcM,MACf,MAAO,cACX,KAAKN,GAAcO,QACf,MAAO,YACX,KAAKP,GAAcQ,MACf,MAAO,WACX,KAAKR,GAAcS,OACf,MAAO,UACX,KAAKT,GAAcU,MACf,MAAO,UACX,KAAKV,GAAcW,MACf,MAAO,UACX,KAAKX,GAAcY,MACf,MAAO,UACX,KAAKZ,GAAca,MAEnB,KAAKb,GAAcc,QACf,MAAO,UACX,KAAKd,GAAce,QACf,MAAO,qBACX,QACI,MAAO,uB,SAzCPf,O,iBAAAA,I,qBAAAA,I,iBAAAA,I,mBAAAA,I,iBAAAA,I,iBAAAA,I,iBAAAA,I,iBAAAA,I,qBAAAA,I,qBAAAA,I,qBAAAA,Q,SCLNgB,G,kDACJ,WAAY3I,GAAa,IAAD,8BACtB,cAAMA,IA8FR4I,KAAO,EA/FiB,EAgGxBC,KAAO,GA9FL,EAAKnK,MAAQ,CACXoK,UAAW,GACXC,SAAS,IAAI1D,MAAOK,WACpBsD,QAAS,CACPxK,MAAM,EACNyK,MAAO,MAETC,YAAY,EACZ/K,YAAY,EACZgL,0BAA0B,EAC1BhJ,WAAW,EACXC,aAAc,GACdpC,OAAQ,GACRC,YAAa,IAfO,E,2FAmBxB,sBAAAlG,EAAA,sDAG0C,KAApC0I,KAAKT,MAAMnD,SAASoB,aACtBwC,KAAK2I,mBAJT,gD,2HAqBA,sBAAArR,EAAA,6DACE0I,KAAK4I,cAAa,GADpB,SAEQ5I,KAAK6I,YAFb,uBAGQ7I,KAAK8I,oBAAmB,GAHhC,OAIE9I,KAAK4I,cAAa,GAJpB,gD,oHAOA,uCAAAtR,EAAA,sEACqB6P,GAAKvJ,eAAeoC,KAAK/B,MAAMqK,SADpD,UAEqB,QADbS,EADR,QAEYnC,KAFZ,gBAGI5G,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,iBACLC,IAAK8N,IANX,0BASuB,OAAdA,EAAKnC,KATd,iBAUM5G,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,iBACLC,SAAKkE,IAbb,8BAgBa,IAAIzG,MAAJ,UAAaqQ,EAAKnC,KAAlB,aAA2BmC,EAAKlC,MAhB7C,mCAqBsBM,GAAKC,cAAcpH,KAAKT,MAAMnD,SAASmB,OAAQyC,KAAKT,MAAMnD,SAASoB,YAAawC,KAAK/B,MAAMqK,SArBjH,QAqBUhD,EArBV,QAsBQwB,EAAUxB,EAAIwB,SACVrI,SAAQ,SAACuK,EAAGC,GAClBnC,EAAQmC,GAAGC,cAAgB,EAAKC,8BAA8BH,EAAE/B,WAElEjH,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,0BACLC,IAAK6L,EAAQC,MAAK,SAACzP,EAAG0P,GAAJ,OAAU1P,EAAE4R,cAAgBlC,EAAEkC,mBA7BtD,mDAgCIlJ,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,0BACLC,SAAKkE,IAnCX,2D,gFAwCA,SAAaoD,GACXvC,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,gBACLC,IAAKsH,M,uEAMT,4CAAAjL,EAAA,6DAAyB8R,EAAzB,mCAEIpJ,KAAKmI,KAAO,GAKR5P,EAAOyH,KAAKT,MAAMH,YAAYvB,wBAC9BwK,EAAY9P,EAAK8Q,MAAMrJ,KAAKmI,KAAOnI,KAAKoI,MAAOpI,KAAKmI,KAAO,GAAKnI,KAAKoI,MAE3EpI,KAAKmI,MAAQ,EACbnI,KAAKM,SAAS,CACZ5C,YAAY,EAAO2K,UAAWe,EAAYf,EAAH,sBAAmBrI,KAAK/B,MAAMoK,WAA9B,YAA4CA,IACnFI,WAAYJ,EAAUpJ,SAAWe,KAAKoI,OAb1C,mBAgBS,GAhBT,gD,iGAmBA,SAA8BnB,GAC5BA,EAASA,EAAOqC,UAAU,GAC1B,IAAMC,EAAcvJ,KAAKT,MAAMH,YAAYxB,eAC3C,GAAmB,MAAf2L,EACF,OAAOrC,GAAcsC,OAGvB,IAAMC,EAAgB,CACpBF,EAAYG,cAAeH,EAAYI,cAAeJ,EAAYK,cAClEL,EAAYM,cAAeN,EAAYO,cAAeP,EAAYQ,cAClER,EAAYS,cAAeT,EAAYU,cAAeV,EAAYW,cAClEX,EAAYY,gBAERC,EAAgB,CACpBb,EAAYc,cAAed,EAAYe,cAAef,EAAYgB,cAClEhB,EAAYiB,cAAejB,EAAYkB,cAAelB,EAAYmB,eAEpE,OAAIzD,IAAWsC,EAAYoB,aAClBzD,GAAcM,MACZ,CAAC+B,EAAYqB,WAAYrB,EAAYsB,YAAatB,EAAYuB,aAAaC,MAAK,SAAAC,GAAE,OAAI/D,IAAW+D,KACnG9D,GAAcO,QACZgC,EAAcsB,MAAK,SAAAC,GAAE,OAAI/D,IAAW+D,KACtC9D,GAAcQ,MACZ+B,EAAcsB,MAAK,SAAAC,GAAE,OAAI/D,EAAOqC,UAAU,KAAO0B,EAAG1B,UAAU,MAChEpC,GAAcS,OACZ8B,EAAcsB,MAAK,SAAAC,GAAE,OAAI/D,EAAOqC,UAAU,KAAO0B,EAAG1B,UAAU,MAChEpC,GAAcU,MACZ6B,EAAcsB,MAAK,SAAAC,GAAE,OAAI/D,EAAOqC,UAAU,KAAO0B,EAAG1B,UAAU,MAChEpC,GAAcW,MACZ4B,EAAcsB,MAAK,SAAAC,GAAE,OAAI/D,EAAOqC,UAAU,KAAO0B,EAAG1B,UAAU,MAChEpC,GAAcY,MACZ2B,EAAcsB,MAAK,SAAAC,GAAE,OAAI/D,EAAOqC,UAAU,KAAO0B,EAAG1B,UAAU,MAChEpC,GAAca,MACZqC,EAAcW,MAAK,SAAAC,GAAE,OAAI/D,EAAOqC,UAAU,KAAO0B,KACnD9D,GAAcc,QAEdd,GAAce,U,qBAIzB,WAAW,IAAD,OACJG,EAAOpO,QA8BX,OA7BAgG,KAAK/B,MAAMoK,UAAU5J,SAAQ,SAAC0D,EAA8B8I,GAC1D,IAAMC,EAAM,eAAC,IAAD,CAASC,QAAQ,EAC3B/K,QAAO,uCAAE,WAAMoI,GAAN,eAAAlR,EAAA,sDACDkO,EADC,UACYrD,EAAKqD,QAAQC,KAAO,KADhC,YACwCtD,EAAKqD,QAAQX,MAAMI,WAAWC,SAAS,EAAG,KADlF,YAC0F/C,EAAKqD,QAAQb,KAAKM,WAAWC,SAAS,EAAG,MAC1I,EAAK3F,MAAM6L,QAAQC,KAAnB,UAA2BzR,EAAQ3C,OAAnC,qBAAsDkL,EAAK8E,OAA3D,YAAqEzB,IAF9D,2CAAF,sDADG,UAKV,qBAAK5F,SAAU,IACf,qBAAKrF,UAAU,gBAAf,SACE,cAAC,IAAD,CAAUA,UAAU,uBAApB,SACG+M,GAAsBnF,EAAK+G,gBADkB,YAAc+B,KAIhE,sBAAK1Q,UAAU,WAAf,UACE,8BACE,eAAC,IAAD,CAAUA,UAAU,uBAApB,UACG4H,EAAKqD,QAAQX,MAAMI,WAAWC,SAAS,EAAG,KAD7C,IACoD/C,EAAKqD,QAAQb,KAAKM,WAAWC,SAAS,EAAG,KAD7F,QAEG/C,EAAK8E,OAFR,QAGG9E,EAAKmJ,OAHR,WAAgD,gBAAkBL,KAMpE,8BACE,cAAC,IAAD,CAAU1Q,UAAU,uBAApB,SACG4H,EAAKoJ,YADwC,eAAiBN,UApB/B,OAAS9I,EAAK8E,QA0BtDmB,EAAKiD,KAAKH,MAEL9C,I,oBAGT,WAAU,IAAD,OACP,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAU7N,UAAU,SAApB,0BACA,cAAC,IAAD,CAAawF,KAAK,MAAMxF,UAAU,SAChCiR,cAAc,qBACd,mBAAiB,cACjBC,SAAS,eACTC,WAAW,eACXnJ,MAAOvC,KAAK/B,MAAMqK,QAClBpH,YAAW,uCAAE,WAAMb,GAAN,SAAA/I,EAAA,6DACX,EAAKgJ,SAAS,CAAEgI,QAASjI,EAAEe,OAAOmB,OAAS,KADhC,SAEL,EAAKoG,mBAFA,2CAAF,6DAOjB,eAAC,IAAD,CAAYnO,MAAO,CAAEiH,UAAW,UAAhC,UAEIzB,KAAKT,MAAMH,YAAYzB,cACrB,cAAC,IAAD,CACE8E,SAAS,SACTC,OAAQ1C,KAAKT,MAAMH,YAAYzB,cAC/B8F,QAAS,0BAGyB,KAApCzD,KAAKT,MAAMnD,SAASoB,YAClB,qCACE,sBAAKjD,UAAU,aAAf,UACE,cAAC,IAAD,CAAUA,UAAU,SAApB,sCACA,cAAC,IAAD,CAAUA,UAAU,kBAAkBgI,MAAOvC,KAAK/B,MAAMV,OAAQoO,YAAY,WAAWzK,YAAa,SAACb,GACnG,EAAKC,SAAS,CAAE/C,OAAQ8C,EAAEe,OAAOmB,OAAS,WAI9C,sBAAKhI,UAAU,aAAf,UACE,cAAC,IAAD,CAAUA,UAAU,SAApB,gCACA,cAAC,IAAD,CAAUA,UAAU,kBAAkBQ,KAAK,WAAWwH,MAAOvC,KAAK/B,MAAMT,YAAa0D,YAAa,SAACb,GACjG,EAAKC,SAAS,CAAE9C,YAAa6C,EAAEe,OAAOmB,OAAS,QAGjD,cAAC,IAAD,CAAWtC,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQ5F,UAAU,SAAS6F,QAAS,SAAAC,GAC/E,EAAKC,SAAS,CAAEoI,0BAA0B,KAD5C,gCAMJ,qCACE,eAAC,IAAD,WACG1I,KAAK4L,UACN,cAAC,IAAD,CAAmBC,UAAU,QAC3BC,UAAW9L,KAAK/B,MAAMwK,WACtBsD,cAAe,SAACjU,GACd,EAAKgR,qBACJhR,EAAG8C,OAAwCoR,YAJhD,SAME,cAAC,IAAD,CACEC,YAAY,+BAIlB,cAAC,IAAD,8HAIR,cAAC,IAAD,CACExJ,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMyK,yBACnB/F,iBAAiB,EACjBE,OAAQ,kWACRC,QAAS,CACP,CACE9F,KAAM,eACNyF,SAAU,mBACVM,QAAS,SAACR,GACR,EAAKjC,SAAS,CACZoI,0BAA0B,MAKhC,CACE1L,KAAM,eACNyF,SAAU,iBACVM,QAAQ,WAAD,4BAAE,WAAOR,GAAP,SAAAjL,EAAA,6DACP,EAAKgJ,SAAS,CACZoI,0BAA0B,IAG5B,EAAKnJ,MAAMzE,SAAS,CAClBC,KAAM,cACNC,IAAK,SACLC,IAAK,EAAKgD,MAAMV,SAGlB,EAAKgC,MAAMzE,SAAS,CAClBC,KAAM,cACNC,IAAK,cACLC,IAAK,EAAKgD,MAAMT,cAdX,SAkBL,EAAKoL,cAAa,GAlBb,SAmBCzB,GAAKC,cAAc,EAAK7H,MAAMnD,SAASmB,OAAQ,EAAKgC,MAAMnD,SAASoB,YAAa,EAAKS,MAAMqK,SAAS,GAnBrG,0DAqBL,EAAKM,cAAa,GACI,kBAAlB,KAAMnF,QAtBL,wBAuBH,EAAKnD,SAAS,CAAEX,aAAc,iCAASD,WAAW,IAvB/C,UAwBG,EAAKiJ,mBAxBR,gCA0BH/O,EAAQiB,OAAO,EAAK0E,MAAMzE,UAC1B,EAAKwF,SAAS,CAAEX,aAAc,yGAAqBD,WAAW,IA3B3D,yDAAF,mDAAC,OAmCd,cAAC,IAAD,CACE+C,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMyB,UACnB8D,aAAc,kBAAM,EAAKlD,SAAS,CAAEZ,WAAW,KAC/C+D,QAASzD,KAAK/B,MAAM0B,aACpB+D,SAAU,gB,GA7TUC,IAAMC,WAqUhCsI,GAAmBpI,YAAiBoE,IAW3BnE,gBATS,SAAC9F,GACvB,MAAO,CACLmB,YAAanB,EAAMmB,YACnBhD,SAAU6B,EAAM7B,YAML2H,CAEbmI,I,SC9VIC,G,kDAEJ,WAAY5M,GAAa,IAAD,8BACtB,cAAMA,IACDtB,MAAQ,CACXmO,oBAAqBpS,MAAe+E,OAAOC,KAAKpF,EAAQS,aAAa4E,SAHjD,E,gDAOxB,WAAgB,IAAD,OAEToN,EADsBtN,OAAOC,KAAKpF,EAAQS,aAAaiS,QAAO,SAACtR,EAAKiO,GAAN,OAAY,EAAKhL,MAAMmO,oBAAoBnD,MAAIxN,KAAI,SAACT,EAAKiO,GAAO,MAAO,CAACjO,IAAKA,EAAKC,IAAK,EAAKsE,MAAMnD,SAASpB,OACpHS,KAAI,SAAA8Q,GAAM,gBAAOA,EAAOvR,IAAd,aAAsBuR,EAAOtR,QAAOuR,KAAK,KAC5GH,EAA0C,KAAtBA,EAAA,mBAAuCA,GAAsB,KACjF,IAAII,EAASzM,KAAKT,MAAMvC,KAClB0P,EAAiB,KAAKhO,KAAK+N,GAC7BJ,IACFI,GAAUC,EAAc,WAAOL,GAAP,WAAiCA,IAG3DzS,EAAQmD,gBAAgB0P,GACxB,IAAME,EAAYtQ,SAASiG,eAAe,aAE1C,OADAsK,YAAgBD,EAAWF,GACpBE,I,oBAGT,WAAU,IAAD,OACP,OACE,cAAC,IAAD,CACEjK,OAAQ1C,KAAKT,MAAMsN,UACnBpK,SAAS,SACTqK,cAAc,EAEdC,cAAe,WAEb,IADA,IAAIX,EAAsC,GACjCnD,EAAI,EAAGA,EAAI,EAAKhL,MAAMmO,oBAAoBnN,OAAQgK,IACzDmD,EAAoBf,MAAK,GAE3B,EAAK/K,SAAS,CAAC8L,oBAAqBA,IACpC,EAAKY,gBAEPxJ,aAAc,kBAAM,EAAKjE,MAAM0N,UAbjC,SAcE,cAAC,IAAD,UACE,sBAAKzS,MAAO,CAAEuH,QAAS,OAAQP,cAAe,SAAU0L,OAAQ,OAAQC,WAAY,UAApF,UACE,8BACE,cAAC,IAAD,CAAU5S,UAAU,SAApB,2FAEF,8BACE,cAAC,IAAD,CAAUA,UAAU,SAApB,kEAEF,qBAAKC,MAAO,CAAE4S,SAAU,EAAGC,WAAY,EAAGtL,QAAS,OAAQoL,WAAY,SAAUG,OAAQ,IAAzF,SACE,wBAAQzL,GAAG,YAAY0L,MAAM,MAAML,OAAO,MAAM1S,MAAO,CAAE8S,OAAQ,gBAEnE,gCACE,cAAC,IAAD,CAAU/S,UAAU,SAApB,0CACA,cAAC,IAAD,UAEIwE,OAAOC,KAAKpF,EAAQS,aAAaoB,KAAI,SAACT,EAAKiO,GAAN,OACnC,eAAC,IAAD,WACE,cAAC,IAAD,CAAU1O,UAAU,uBAApB,SAA4CX,EAAQS,YAAYW,KAChE,cAAC,IAAD,CAAW+E,KAAK,MAAMmB,YAAa,SAAAb,GACjC,IAAM+L,EAAuB,EAAKnO,MAAMmO,oBACxCA,EAAoBnD,GAAK5I,EAAEe,OAAOH,QAClC,EAAKX,SAAS,CAAC8L,oBAAqBA,IACpC,EAAKY,oBANT,+BAAsC/D,YAa9C,8BACE,cAAC,IAAD,CAAWhJ,KAAK,UAAUC,MAAM,QAAQC,KAAK,QAAQC,QAAS,kBAAM,EAAKb,MAAM0N,UAA/E,uC,GAvEgBtJ,IAAMC,WAwFrBG,gBARS,SAAC9F,GACvB,MAAO,CACL7B,SAAU6B,EAAM7B,YAML2H,CAEboI,ICnFIqB,G,kDACJ,WAAYjO,GAAmB,IAAD,8BAC5B,cAAMA,IACDtB,MAAQ,CACXoJ,sBAAkBlI,EAClBO,WAAW,EACXC,aAAc,IAGhB,EAAKkJ,YARuB,E,2FAW9B,sBAAAvR,EAAA,0F,oHAGA,4BAAAA,EAAA,6DACE0I,KAAK4I,cAAa,GADpB,SAEiCzB,GAAKE,iBAClCrH,KAAKT,MAAMnD,SAASmB,OACpByC,KAAKT,MAAMnD,SAASoB,YACpBwC,KAAKT,MAAMkO,MAAMC,OAAOzG,OACxBjH,KAAKT,MAAMkO,MAAMC,OAAOlI,QAAQmI,WAAW,IAAK,MANpD,OAEQtG,EAFR,OAQErH,KAAKM,SAAS,CAAE+G,iBAAkBA,IAClCrH,KAAK4I,cAAa,GATpB,gD,gFAYA,SAAarG,GACXvC,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,gBACLC,IAAKsH,M,oBAIT,WAAU,IAAD,OACDqL,EAAM5N,KAAK/B,MAAMoJ,iBACvB,OACErH,KAAKT,MAAMH,YAAYzB,cACrB,cAAC,IAAD,CACE8E,SAAS,SACTC,OAAQ1C,KAAKT,MAAMH,YAAYzB,cAC/B8F,QAAS,0BAGX,eAAC,IAAD,WACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAWxD,KAAK,QAAQF,KAAK,QAAQK,QAAS,SAAAC,GAAC,OAAI,EAAKd,MAAM6L,QAAQyC,UAAtE,SACE,cAAC,IAAD,CAAShO,KAAMiO,IAAW/N,KAAK,gBAGjC,cAAC,IAAD,CAAUxF,UAAU,SAApB,2CAIJ,eAAC,IAAD,CAAYC,MAAO,CAAEiH,UAAW,UAAhC,UAEE,qBAAKlH,UAAU,2BAA2BC,MAAO,CAAEiH,UAAW,QAA9D,gBAAyEmM,QAAzE,IAAyEA,OAAzE,EAAyEA,EAAKrC,aAE9E,8BACE,cAAC,IAAD,CAAUhR,UAAU,2BAA2BC,MAAO,CAAEuT,MAAO,OAA/D,gBAAyEH,QAAzE,IAAyEA,OAAzE,EAAyEA,EAAK3G,WAGhF,eAAC,IAAD,WACE,eAAC,IAAD,CAAU1M,UAAU,2BAApB,iBAAgDqT,QAAhD,IAAgDA,OAAhD,EAAgDA,EAAKpI,QAArD,cAAoEoI,QAApE,IAAoEA,OAApE,EAAoEA,EAAKlI,eACzE,cAAC,IAAD,CAAUnL,UAAU,2BAA2BC,MAAO,CAAEiH,UAAW,SAAnE,SAA+EzB,KAAKT,MAAMnD,SAASmB,YAInG,eAAC,IAAD,WACE,cAAC,IAAD,CAAeyQ,MAAM,OAAOD,MAAM,UAAlC,SACE,cAAC,IAAD,CAAUxT,UAAU,SAApB,wCAGF,cAAC,IAAD,UACE,eAAC,IAAD,CAAUA,UAAU,uBAApB,wDAAkDqT,QAAlD,IAAkDA,OAAlD,EAAkDA,EAAKK,eAEzD,cAAC,IAAD,UACE,eAAC,IAAD,CAAU1T,UAAU,uBAApB,kDAAiDqT,QAAjD,IAAiDA,OAAjD,EAAiDA,EAAKM,mBAExD,eAAC,IAAD,WACE,cAAC,IAAD,CAAUnO,KAAK,QAAQxF,UAAU,uBAAuBC,MAAO,CAAE2T,WAAY,QAA7E,wCACA,cAAC,IAAD,CAAUpO,KAAK,MAAMxF,UAAU,uBAAuBC,MAAO,CAAEiH,UAAW,QAAS0M,WAAY,QAA/F,6BAbJ,OAgBIP,QAhBJ,IAgBIA,OAhBJ,EAgBIA,EAAK9G,QAAQrL,KAAI,SAACuN,EAAGC,GAAJ,OACf,eAAC,IAAD,WACE,eAAC,IAAD,CAAUlJ,KAAK,QAAQxF,UAAU,uBAAjC,UAAyDyO,EAAEoF,YAA3D,IAAyEpF,EAAEqF,SAA3E,OACA,cAAC,IAAD,CAAUtO,KAAK,MAAMxF,UAAU,uBAAuBC,MAAO,CAAEiH,UAAW,SAA1E,SAAsFuH,EAAEsC,WAF1F,cAAqBrC,OAMzB,cAAC,IAAD,UACE,eAAC,IAAD,CAAUlJ,KAAK,MAAMxF,UAAU,uBAAuBC,MAAO,CAAEiH,UAAW,SAA1E,sCACMmM,QADN,IACMA,OADN,EACMA,EAAKtC,OADX,iBAON,cAAC,IAAD,CACE7I,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMyB,UACnB8D,aAAc,kBAAM,EAAKlD,SAAS,CAAEZ,WAAW,KAC/C+D,QAASzD,KAAK/B,MAAM0B,aACpB+D,SAAU,gB,GA1GEC,IAAMC,WA2H1B0K,GAAaxK,YAAiB0J,IAErBzJ,gBAXS,SAAC9F,GACvB,MAAO,CACLmB,YAAanB,EAAMmB,YACnBhD,SAAU6B,EAAM7B,YAQL2H,CAEbuK,ICjIIC,I,yDAEJ,WAAYhP,GAAmB,IAAD,uBAC5B,cAAMA,IAFRiP,aAC8B,EAG5B,IAAMC,EAAc,IAAI7J,KAClBa,EAAOgJ,EAAYzJ,cACnBH,EAAQ4J,EAAY3J,WAAa,EALX,OAM5B,EAAK0J,QAAU,IAAI5J,KACjBa,EACCZ,EAAQ,IAAO,EAAIA,EAAQ,EAAIA,EAAQ,EACxC,GAEF,EAAK5G,MAAQ,CACXqK,QAAS,EAAKkG,QAAQvJ,WACtBvF,WAAW,EACXC,aAAc,IAdY,E,oDAkB9B,WACEK,KAAK6I,c,8DAGP,4BAAAvR,EAAA,6DACE0I,KAAK4I,cAAa,GADpB,SAEqBzB,GAAKvJ,eAAeoC,KAAK/B,MAAMqK,SAFpD,UAGqB,QADbS,EAFR,QAGYnC,KAHZ,gBAII5G,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,iBACLC,IAAK8N,IAPX,0BAUuB,OAAdA,EAAKnC,KAVd,iBAWM5G,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,iBACLC,SAAKkE,IAdb,8BAiBa,IAAIzG,MAAJ,UAAaqQ,EAAKnC,KAAlB,aAA2BmC,EAAKlC,MAjB7C,QAoBE7G,KAAK4I,cAAa,GApBpB,iD,gFAuBA,SAAarG,GACXvC,KAAKT,MAAMzE,SAAS,CAClBC,KAAM,kBACNC,IAAK,gBACLC,IAAKsH,M,oBAIT,WAAU,IAAD,OACDmM,EAAM1O,KAAKT,MAAMH,YAAYxB,eACnC,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAWqC,KAAK,QAAQF,KAAK,QAAQK,QAAS,SAAAC,GAAC,OAAI,EAAKd,MAAM6L,QAAQyC,UAAtE,SACE,cAAC,IAAD,CAAShO,KAAMiO,IAAW/N,KAAK,gBAGjC,cAAC,IAAD,CAAUxF,UAAU,SAApB,sCAEA,cAAC,IAAD,CAAawF,KAAK,MAAMxF,UAAU,SAChCiR,cAAc,sBACdmD,YAAY,oBACZC,gBAAgB,qFAChB,mBAAiB,cACjBnD,SAAS,eACTC,WAAW,eACXnJ,MAAOvC,KAAK/B,MAAMqK,QAClBpH,YAAW,uCAAE,WAAMb,GAAN,SAAA/I,EAAA,6DACX,EAAKgJ,SAAS,CAAEgI,QAASjI,EAAEe,OAAOmB,OAAS,KADhC,SAEL,EAAKsG,YAFA,2CAAF,6DAOjB,eAAC,IAAD,CAAYrO,MAAO,CAAEiH,UAAW,UAAhC,UAGIzB,KAAKT,MAAMH,YAAYzB,eAAwB,MAAP+Q,EACtC,cAAC,IAAD,CACEjM,SAAS,SACTC,OAAQ1C,KAAKT,MAAMH,YAAYzB,cAC/B8F,QAAS,0BAGX,sBAAKlJ,UAAU,QAAf,UACE,sBAAKA,UAAU,MAAf,UACE,cAAC,IAAD,CAAUA,UAAU,QAApB,gCACA,sBAAKA,UAAU,QAAf,UACE,sBAAMA,UAAU,sBAAhB,SAAuCmU,EAAI/D,eAC3C,sBAAMpQ,UAAU,aAAhB,0HAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,sBAAKA,UAAU,QAAf,UAEI,CAACmU,EAAI9D,WAAY8D,EAAI7D,YAAa6D,EAAI5D,aAAawB,QAAO,SAAAtD,GAAC,MAAU,KAANA,KAAUvN,KAAI,SAAAuN,GAAC,OAC5E,sBAAMzO,UAAU,sBAAhB,SAAuCyO,OAG3C,sBAAMzO,UAAU,aAAhB,wHAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,sBAAKA,UAAU,QAAf,UAEI,CACEmU,EAAIhF,cAAegF,EAAI/E,cAAe+E,EAAI9E,cAC1C8E,EAAI7E,cAAe6E,EAAI5E,cAAe4E,EAAI3E,cAC1C2E,EAAI1E,cAAe0E,EAAIzE,cAAeyE,EAAIxE,cAC1CwE,EAAIvE,gBACJmC,QAAO,SAAAtD,GAAC,MAAU,KAANA,KAAUjC,MAAK,SAACzP,EAAG0P,GAAJ,OAAW1P,GAAK0P,KAAGvL,KAAI,SAAAuN,GAAC,OACnD,sBAAMzO,UAAU,sBAAhB,SAAuCyO,OAG3C,sBAAMzO,UAAU,aAAhB,uHAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,qBAAKA,UAAU,QAAf,SACE,sBAAMA,UAAU,aAAhB,yGAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,qBAAKA,UAAU,QAAf,SACE,sBAAMA,UAAU,aAAhB,yGAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,qBAAKA,UAAU,QAAf,SACE,sBAAMA,UAAU,aAAhB,yGAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,qBAAKA,UAAU,QAAf,SACE,sBAAMA,UAAU,aAAhB,yGAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,0BACA,qBAAKA,UAAU,QAAf,SACE,sBAAMA,UAAU,aAAhB,yGAIJ,sBAAKA,UAAU,MAAf,UACE,qBAAKA,UAAU,QAAf,sCACA,sBAAKA,UAAU,QAAf,UAEI,CACEmU,EAAIrE,cAAeqE,EAAIpE,cAAeoE,EAAInE,cAC1CmE,EAAIlE,cAAekE,EAAIjE,cAAeiE,EAAIhE,eAC1C4B,QAAO,SAAAtD,GAAC,MAAU,KAANA,KAAUvN,KAAI,SAAAuN,GAAC,OAC3B,sBAAMzO,UAAU,sBAAhB,SAAuCyO,OAG3C,sBAAMzO,UAAU,aAAhB,yHAOV,cAAC,IAAD,CACEkI,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMyB,UACnB8D,aAAc,kBAAM,EAAKlD,SAAS,CAAEZ,WAAW,KAC/C+D,QAASzD,KAAK/B,MAAM0B,aACpB+D,SAAU,gB,GA5LSC,IAAMC,YA6M/BiL,GAAkB/K,YAAiByK,IAE1BxK,gBAXS,SAAC9F,GACvB,MAAO,CACLmB,YAAanB,EAAMmB,YACnBhD,SAAU6B,EAAM7B,YAQL2H,CAEb8K,IC/LIC,GAA2BpO,OAAeoO,mBAE5CC,GCnCW,WACX,IAAIC,EAAmB5V,aAAakF,QAAQ1E,EAAQC,WAQpD,OAPwB,MAApBmV,EACaC,YAAYC,EAAS9Q,KAAKC,MAAM2Q,IAGhCC,YAAYC,GD6BrBC,GAgBZC,YAAY,CACVC,KAAM,KACNC,kBAAkB,IAGb,IAAIC,GAAuB,CAChCC,UAAW,SAAUC,KACrBC,SAAU,SAAUD,MA2BhBE,G,4JACJ,WACE,OACE,cAAC,IAAD,CAAUZ,MAAOA,GAAjB,SACE,cAACa,GAAD,eAAa5P,KAAKT,c,GAJPoE,IAAMC,WAUnBiM,G,kDAIJ,WAAYtQ,GAAa,IAAD,EAuBtB,IAvBsB,qBACtB,cAAMA,IAJRuQ,qBAGwB,IAFxBC,4BAEwB,IAgGxBC,cAhGwB,EAEjB,EAAKzQ,MAAMnD,SAASiB,WACvBzD,EAAQQ,gBAGQ,OAAlB0U,SAAkB,IAAlBA,OAAoBmB,QAAQ,YAAY,SAAC1X,GACvC,OAAQA,EAAKiQ,OACX,IAAK,UACHuG,GAAMjU,SAAS,CACbC,KAAM,kBACNC,IAAK,cACLC,IAAK1C,EAAK6E,cAKA,OAAlB0R,SAAkB,IAAlBA,OAAoBoB,KAAK,SAAU,CAAE1H,MAAO,UAE5C,EAAKsH,gBAAkB,KAIhBzT,SAASkC,KAAKC,UAAUS,OAAS,GACtC5C,SAASkC,KAAKC,UAAUG,OAAOtC,SAASkC,KAAKC,UAAU2D,KAAK,IAE9D9F,SAASkC,KAAKC,UAAUI,OAAxB,eAAuC,EAAKW,MAAMnD,SAASkB,QAAS,GAGpE,IAAM6S,EAAcC,IAAY/R,MAAM,EAAKkB,MAAMoB,SAAS0P,QA7BpC,OA8BlBF,EAAY/T,WACd,EAAK2T,uBAAyB3W,aAAakF,QAAQ1E,EAAQC,WAC1DsW,EAAY/T,SAAoBkU,MAAM,KAAK7R,SAAQ,SAAA8R,GAClD,IAAMhE,EAASgE,EAAQD,MAAM,KAC7B,EAAK/Q,MAAMzE,SAAS,CAClBC,KAAM,cACNC,IAAKuR,EAAO,GACZtR,KAAMsR,EAAO,SAInB3S,EAAQuC,cAAc,EAAKoD,MAAMnD,UAEjC,EAAK6B,MAAQ,CACXuS,iBAAiB,EACjBC,4BAAsD,MAAxBN,EAAY/T,UAAmD,MAA/B,EAAK2T,yBAAmC,EACtGrQ,WAAW,EACXC,aAAc,IAGhB4P,GAAqBG,SAAW,SAACD,GAC/B,EAAKK,gBAAkBL,EACvB,EAAKnP,SAAS,CAAEkQ,iBAAiB,KAGnCjB,GAAqBC,UAAY,SAACC,KAIH,qBAApBiB,kBACTA,gBAAgBC,YAChBD,gBAAgBE,UAIblX,UAAkBsW,WACrB,EAAKa,iBACLxU,SAASyU,iBAAiB,mBAA1B,sBAA8C,sBAAAxZ,EAAA,sDACX,YAA7B+E,SAAS0U,gBACX,EAAKF,iBAEL,EAAKG,wBAJqC,6CAS9BxZ,UAAUC,KAAKmC,EAAQzC,QAE/B8Z,gBAAkB,SAAUzI,GAC1BA,EAAM5N,OAAe5C,OAC5BkZ,kBAAkB,SACrB1Y,QAAQpB,IAAR,sBAjFoB,E,sDAqFxB,WAGE,IAFAgC,aAAayF,QAAQjF,EAAQC,UAAWmG,KAAK+P,wBAC7C/P,KAAKT,MAAMzE,SAAS,CAAEC,KAAM,kBACrBsB,SAASkC,KAAKC,UAAUS,OAAS,GACtC5C,SAASkC,KAAKC,UAAUG,OAAOtC,SAASkC,KAAKC,UAAU2D,KAAK,IAE9D9F,SAASkC,KAAKC,UAAUI,OAAxB,eAAuCoB,KAAKT,MAAMnD,SAASkB,QAAS,GACpE1D,EAAQuC,cAAc6D,KAAKT,MAAMnD,Y,mEAKnC,4BAAA9E,EAAA,kEAGoB,OADV0Y,EAAYtW,UAAkBsW,UAFxC,gCAI4BA,EAASmB,QAAQ,UAJ7C,OAIMnR,KAAKgQ,SAJX,OAKMxX,QAAQpB,IAAI,kCALlB,uBAOMoB,QAAQC,MAAM,oCAPpB,0DAWID,QAAQpB,IAAR,UAAe,KAAIga,KAAnB,aAA4B,KAAI3N,UAChCjL,QAAQpB,KAAI,IAAIsB,OAAQC,OAZ5B,0D,gIAgBA,sBAAArB,EAAA,yDACuB,MAAjB0I,KAAKgQ,SADX,gCAEUhQ,KAAKgQ,SAASqB,UAFxB,OAGIrR,KAAKgQ,SAAW,KAChBxX,QAAQpB,IAAI,iCAJhB,gD,sFAQA,WASEoB,QAAQpB,IAAIsJ,OAAOC,SAAS0P,QAC5B,IAAMiB,EAAe,gBAAgBC,KAAK7Q,OAAOC,SAAS0P,QACpDmB,EAAe,gBAAgBD,KAAK7Q,OAAOC,SAAS0P,QAC1D,GAAqB,OAAjBiB,EAAuB,CACzB,IAAMG,EAAQC,mBAAmBJ,EAAa,IAE1CK,EAAQ,GAIZ,OAHqB,OAAjBH,IACFG,EAAQD,mBAAmBF,EAAa,KAEnC,cAAC,IAAD,CAAUI,GAAIH,EAAQE,IACxB,GAAIjR,OAAOC,SAASkR,WAAhB,UAAgCjY,EAAQ3C,OAAxC,MAAqDyJ,OAAOC,SAASkR,WAAhB,UAAgCjY,EAAQ3C,QACtG,OAAO,cAAC,IAAD,CAAU2a,GAAE,UAAKhY,EAAQ3C,OAAb,iB,oBAIvB,WAAU,IAAD,WACP,OACE,eAAC,IAAD,WACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,eAAC,IAAD,CAAiB6a,UAAU,EAA3B,UAEE,cAAC,IAAD,CAAOC,KAAI,UAAKnY,EAAQ3C,OAAb,mBAAsC+a,OAAQ,SAACzS,GAAD,OAAgB,cAAC,GAAD,eAAsBA,KAAW0S,OAAO,IACjH,cAAC,IAAD,CAAOF,KAAI,UAAKnY,EAAQ3C,OAAb,oCAAuD+a,OAAQ,SAACzS,GAAD,OAAgB,cAAC,GAAD,eAAgBA,KAAW0S,OAAO,IAC5H,cAAC,IAAD,CAAOF,KAAI,UAAKnY,EAAQ3C,OAAb,sBAAyC+a,OAAQ,SAACzS,GAAD,OAAgB,cAAC,GAAD,eAAqBA,KAAW0S,OAAO,IACnH,cAAC,IAAD,CAAOF,KAAI,UAAKnY,EAAQ3C,OAAb,aAAgC+a,OAAQ,SAACzS,GAAD,OAAgB,cAAC,EAAD,eAAkBA,OACrF,cAAC,IAAD,CAAOwS,KAAI,UAAKnY,EAAQ3C,OAAb,KAAwB+a,OAAQ,WAAQ,OAAO,EAAKE,sBAAyBD,OAAO,OAEjG,eAAC,IAAD,CAAWlS,KAAK,SAAhB,UACE,cAAC,IAAD,CAAcoS,IAAI,WAAWxX,KAAI,UAAKf,EAAQ3C,OAAb,aAAjC,SACE,cAAC,IAAD,CAAS4I,KAAMuS,QAEjB,cAAC,IAAD,CAAcD,IAAI,cAAcxX,KAAI,UAAKf,EAAQ3C,OAAb,gBAApC,SACE,cAAC,IAAD,CAAS4I,KAAMwS,QAEjB,cAAC,IAAD,CAAcF,IAAI,WAAWxX,KAAI,UAAKf,EAAQ3C,OAAb,aAAjC,SACE,cAAC,IAAD,CAAS4I,KAAMzD,gBAKvB,cAAC,IAAD,CACEqG,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMuS,gBACnB7N,iBAAiB,EACjBC,aAAc,SAAC9K,GAAQ,IAAD,QAGpB,YAAKgY,uBAAL,mBAAsBjU,kBAAtB,SAAkCyW,YAAY,CAAEvX,KAAM,iBACtD,YAAK+U,uBAAL,mBAAsBhU,eAAtB,SAA+BwW,YAAY,CAAEvX,KAAM,kBAErD8H,OAAQ,0BACRC,QAAS,CACP,CACE9F,KAAM,eACNyF,SAAU,iBACVM,QAAS,SAACR,GACR,EAAKjC,SAAS,CACZkQ,iBAAiB,SAO3B,cAAC+B,GAAD,4BAEIvV,KAAI,UAAEgD,KAAKT,MAAMzB,sBAAb,aAAE,EAA2Bd,KACjC6P,WAAW,UAAA7M,KAAKT,MAAMzB,sBAAX,eAA2BC,QAAQ,EAC9CkP,OAAQ,WACN8B,GAAMjU,SAAS,CACbC,KAAM,kBACNC,IAAK,iBACLC,IAAK,CAAE8C,MAAM,OAEXiC,KAAKT,SAIf,cAAC,IAAD,CACEkD,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMwS,4BACnBjN,aAAc,kBAAM,EAAKlD,SAAS,CAAEmQ,6BAA6B,KACjEhN,QAAO,4GACPX,QAAS,CACP,CACE9F,KAAM,eACNwV,KAAM,SACNzP,QAAS,kBAAM,EAAKzC,SAAS,CAAEmQ,6BAA6B,MAE9D,CACEzT,KAAM,eACN+F,QAAS,kBAAM,EAAK0P,0BAK1B,cAAC,IAAD,CACEhQ,SAAS,SACTC,OAAQ1C,KAAK/B,MAAMyB,UACnB8D,aAAc,kBAAM,EAAKlD,SAAS,CAAEZ,WAAW,KAC/C+D,QAASzD,KAAK/B,MAAM0B,aACpB+D,SAAU,a,GA7OGC,IAAMC,WA4PvBgM,GAAU7L,aARQ,SAAC9F,GACvB,MAAO,CACLH,eAAgBG,EAAMmB,YAAYtB,eAClC1B,SAAU6B,EAAM7B,SAChBgD,YAAanB,EAAMmB,eAIP2E,CAEd8L,IAKa6C,GAFHC,YAAWhD,IEjWjBiD,GAAcC,QACW,cAA7BnS,OAAOC,SAASmS,UAEa,UAA7BpS,OAAOC,SAASmS,UAEhBpS,OAAOC,SAASmS,SAASrF,MAAM,2DA0CjC,SAASsF,GAAgBC,EAAeC,GACtCvZ,UAAU0B,cACP8X,SAASF,GACT1X,MAAK,SAACmU,GAQLA,EAAa0D,cAAgB,WAE3B,IAAMC,EAAmB3D,EAAa5T,WACd,MAApBuX,IAGJA,EAAiBC,cAAgB,WAC/B7a,QAAQpB,IAAR,0CAA+Cgc,EAAiBnV,QACjC,cAA3BmV,EAAiBnV,QACfvE,UAAU0B,cAAckY,YAI1B9a,QAAQpB,IACN,+GAKE6b,GAAUA,EAAOvD,UACnBuD,EAAOvD,SAASD,KAMlBjX,QAAQpB,IAAI,sCAGR6b,GAAUA,EAAOzD,WACnByD,EAAOzD,UAAUC,WAO5B8D,OAAM,SAAA9a,GACLD,QAAQC,MAAM,4CAA6CA,MCpGjEmB,EAAQG,eAERyZ,IAASxB,OAAO,cAAC,IAAD,UAAe,cAAC,GAAD,MAAyB3V,SAASiG,eAAe,SDezE,SAAkB2Q,GACvB,GAA6C,kBAAmBvZ,UAAW,CAGzE,GADkB,IAAI+Z,IAAIvc,QAAwBwJ,OAAOC,SAAShG,MACpDiG,SAAWF,OAAOC,SAASC,OAIvC,OAGFF,OAAOoQ,iBAAiB,QAAQ,WAC9B,IAAMkC,EAAK,UAAM9b,QAAN,sBAEP0b,KAyEV,SAAiCI,EAAeC,GAE9CS,MAAMV,EAAO,CACXvO,QAAS,CAAE,iBAAkB,YAE5BnJ,MAAK,SAAAqY,GAEJ,IAAMC,EAAcD,EAASlP,QAAQpM,IAAI,gBAEnB,MAApBsb,EAASpM,QACO,MAAfqM,IAA8D,IAAvCA,EAAYC,QAAQ,cAG5Cna,UAAU0B,cAAc0Y,MAAMxY,MAAK,SAACmU,GAClCA,EAAasE,aAAazY,MAAK,WAC7BoF,OAAOC,SAASqT,eAKpBjB,GAAgBC,EAAOC,MAG1BM,OAAM,WACL/a,QAAQpB,IAAI,oEA/FV6c,CAAwBjB,EAAOC,GAI/BvZ,UAAU0B,cAAc0Y,MAAMxY,MAAK,WACjC9C,QAAQpB,IACN,+GAMJ2b,GAAgBC,EAAOC,OCtC/B7X,CAAuB,CACnBoU,UAAW,SAACC,GAA8CjX,QAAQpB,IAAI,wBAAyBmY,GAAqBC,UAAUC,IAC9HC,SAAU,SAACD,GAA8CjX,QAAQpB,IAAI,sBAAuBmY,GAAqBG,SAASD,O,mpGCjB9H,IAAIhU,EAAM,CACT,8BAA+B,CAC9B,IACA,GAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,GAED,0BAA2B,CAC1B,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,sBAAuB,CACtB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,qBAAsB,CACrB,IACA,IAED,mCAAoC,CACnC,IACA,IAED,uBAAwB,CACvB,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,wBAAyB,CACxB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,uBAAwB,CACvB,IACA,GAED,uBAAwB,CACvB,IACA,IAED,yBAA0B,CACzB,IACA,GAED,8BAA+B,CAC9B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,uBAAwB,CACvB,IACA,IAED,6BAA8B,CAC7B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,+BAAgC,CAC/B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,yBAA0B,CACzB,IACA,IAED,yBAA0B,CACzB,IACA,IAED,4BAA6B,CAC5B,IACA,IAED,2BAA4B,CAC3B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,sBAAuB,CACtB,IACA,IAED,0BAA2B,CAC1B,IACA,IAED,uBAAwB,CACvB,IACA,IAED,wBAAyB,CACxB,IACA,IAED,gCAAiC,CAChC,IACA,KAGF,SAASyY,EAAoB/b,GAC5B,IAAIgc,EAAoBC,EAAE3Y,EAAKtD,GAC9B,OAAOT,QAAQyD,UAAUG,MAAK,WAC7B,IAAI+E,EAAI,IAAI3H,MAAM,uBAAyBP,EAAM,KAEjD,MADAkI,EAAEuG,KAAO,mBACHvG,KAIR,IAAIgU,EAAM5Y,EAAItD,GAAM0J,EAAKwS,EAAI,GAC7B,OAAOF,EAAoB9T,EAAEgU,EAAI,IAAI/Y,MAAK,WACzC,OAAO6Y,EAAoBtS,MAG7BqS,EAAoBlV,KAAO,WAC1B,OAAOD,OAAOC,KAAKvD,IAEpByY,EAAoBrS,GAAK,GACzByS,EAAOC,QAAUL,G,mBChMjB,IAAIzY,EAAM,CACT,sBAAuB,CACtB,IACA,KAGF,SAASyY,EAAoB/b,GAC5B,IAAIgc,EAAoBC,EAAE3Y,EAAKtD,GAC9B,OAAOT,QAAQyD,UAAUG,MAAK,WAC7B,IAAI+E,EAAI,IAAI3H,MAAM,uBAAyBP,EAAM,KAEjD,MADAkI,EAAEuG,KAAO,mBACHvG,KAIR,IAAIgU,EAAM5Y,EAAItD,GAAM0J,EAAKwS,EAAI,GAC7B,OAAOF,EAAoB9T,EAAEgU,EAAI,IAAI/Y,MAAK,WACzC,OAAO6Y,EAAoBtS,MAG7BqS,EAAoBlV,KAAO,WAC1B,OAAOD,OAAOC,KAAKvD,IAEpByY,EAAoBrS,GAAK,GACzByS,EAAOC,QAAUL,I","file":"static/js/main.e1174b67.chunk.js","sourcesContent":["import { isPlatform, IonLabel } from '@ionic/react';\n\nconst pwaUrl = process.env.PUBLIC_URL || '';\n\nconst tweiDb = 'tweiDb';\nlet log = '';\n\nfunction logout(dispatch: Function) {\n  dispatch({\n    type: \"SET_KEY_VAL\",\n    key: 'cardNo',\n    val: '',\n  });\n\n  dispatch({\n    type: \"SET_KEY_VAL\",\n    key: 'cardEncrypt',\n    val: '',\n  });\n}\n\nasync function getFileFromIndexedDB(fileName: string) {\n  const dbOpenReq = indexedDB.open(tweiDb);\n\n  return new Promise(function (ok, fail) {\n    dbOpenReq.onsuccess = async function (ev) {\n      const db = dbOpenReq.result;\n\n      try {\n        const trans = db.transaction([\"store\"], 'readwrite');\n        let req = trans.objectStore('store').get(fileName);\n        req.onsuccess = async function (_ev) {\n          const data = req.result;\n          if (!data) {\n            console.error(`${fileName} loading failed!`);\n            console.error(new Error().stack);\n            return fail();\n          }\n          return ok(data);\n        };\n      } catch (err) {\n        console.error(err);\n      }\n    };\n  });\n}\n\nasync function saveFileToIndexedDB(fileName: string, data: any) {\n  const dbOpenReq = indexedDB.open(tweiDb);\n  return new Promise<void>((ok, fail) => {\n    dbOpenReq.onsuccess = async (ev: Event) => {\n      const db = dbOpenReq.result;\n\n      const transWrite = db.transaction([\"store\"], 'readwrite')\n      const reqWrite = transWrite.objectStore('store').put(data, fileName);\n      reqWrite.onsuccess = (_ev: any) => ok();\n      reqWrite.onerror = (_ev: any) => fail();\n    };\n  });\n}\n\nasync function removeFileFromIndexedDB(fileName: string) {\n  const dbOpenReq = indexedDB.open(tweiDb);\n  return new Promise<void>((ok, fail) => {\n    try {\n      dbOpenReq.onsuccess = (ev: Event) => {\n        const db = dbOpenReq.result;\n\n        const transWrite = db.transaction([\"store\"], 'readwrite')\n        try {\n          const reqWrite = transWrite.objectStore('store').delete(fileName);\n          reqWrite.onsuccess = (_ev: any) => ok();\n          reqWrite.onerror = (_ev: any) => fail();\n        } catch (err) {\n          console.error(err);\n        }\n      };\n    } catch (err) {\n      fail(err);\n    }\n  });\n}\n\nasync function clearIndexedDB() {\n  const dbOpenReq = indexedDB.open(tweiDb);\n  return new Promise<void>((ok, fail) => {\n    dbOpenReq.onsuccess = async (ev: Event) => {\n      const db = dbOpenReq.result;\n\n      const transWrite = db.transaction([\"store\"], 'readwrite')\n      const reqWrite = transWrite.objectStore('store').clear();\n      reqWrite.onsuccess = (_ev: any) => ok();\n      reqWrite.onerror = (_ev: any) => fail();\n    };\n  });\n}\n\nasync function clearAppData() {\n  localStorage.clear();\n  await clearIndexedDB();\n}\n\n//const electronBackendApi: any = (window as any).electronBackendApi;\n\nconst consoleLog = console.log.bind(console);\nconst consoleError = console.error.bind(console);\n\nfunction getLog() {\n  return log;\n}\n\nfunction enableAppLog() {\n  console.log = function () {\n    log += '----- Info ----\\n';\n    log += (Array.from(arguments)) + '\\n';\n    consoleLog.apply(console, arguments as any);\n  };\n\n  console.error = function () {\n    log += '----- Error ----\\n';\n    log += (Array.from(arguments)) + '\\n';\n    consoleError.apply(console, arguments as any);\n  };\n}\n\nfunction disableAppLog() {\n  log = '';\n  console.log = consoleLog;\n  console.error = consoleError;\n}\n\n//const webkit = (window as any).webkit;\nfunction copyToClipboard(text: string) {\n  try {\n    navigator.clipboard && navigator.clipboard.writeText(text);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction isMacCatalyst() {\n  return isPlatform('ios') && navigator.platform === 'MacIntel';\n}\n\nconst Globals = {\n  pwaUrl,\n  storeFile: 'tweiSettings.json',\n  getLog,\n  enableAppLog,\n  disableAppLog,\n  tweiDb,\n  appSettings: {\n    'theme': '佈景主題',\n    'uiFontSize': 'UI字型大小',\n  } as Record<string, string>,\n  fetchErrorContent: (\n    <div className='contentCenter'>\n      <IonLabel>\n        <div>\n          <div>連線失敗!</div>\n          <div style={{ fontSize: 'var(--ui-font-size)', paddingTop: 24 }}>如果問題持續發生，請執行<a href={`${pwaUrl}/settings`} target=\"_self\">設定頁</a>的 app 異常回報功能。</div>\n        </div>\n      </IonLabel>\n    </div>\n  ),\n  logout,\n  updateApp: () => {\n    return new Promise(async resolve => {\n      navigator.serviceWorker.getRegistrations().then(async regs => {\n        const hasUpdates = await Promise.all(regs.map(reg => (reg.update() as any).then((newReg: ServiceWorkerRegistration) => {\n          return newReg.installing !== null || newReg.waiting !== null;\n        })));\n        resolve(hasUpdates.reduce((prev, curr) => prev || curr, false));\n      });\n    });\n  },\n  updateCssVars: (settings: any) => {\n    document.documentElement.style.cssText = `--ui-font-size: ${settings.uiFontSize}px;`\n  },\n  isMacCatalyst,\n  isTouchDevice: () => {\n    return (isPlatform('ios') && !isMacCatalyst()) || isPlatform('android');\n  },\n  isStoreApps: () => {\n    return isPlatform('pwa') || isPlatform('electron');\n  },\n  getFileFromIndexedDB,\n  saveFileToIndexedDB,\n  removeFileFromIndexedDB,\n  clearAppData,\n  copyToClipboard,\n};\n\nexport default Globals;\n","export class Settings {\n    version: number = 1;\n    hasAppLog: boolean = true;\n    theme: number = 2;\n    uiFontSize: number = 24;\n    cardNo: string = '';\n    cardEncrypt: string = '';\n}\n","import { CarrierInvChkDetailExt } from \"./CarrierInvChk\";\nimport { QryWinningList } from \"./QryWinningList\";\n\nexport class TmpSettings {\n    fetchError: boolean = false;\n    isLoadingData: boolean = false;\n    qryWinningList: QryWinningList | undefined;\n    carrierInvChkDetailsExt: CarrierInvChkDetailExt[] = [];\n    shareTextModal = { text: '', show: false };\n}\n","import { combineReducers } from \"redux\"\n\nimport settings from \"./setReducer\"\nimport tmpSettings from \"./tmpSetReducer\"\n\nexport default combineReducers({\n  settings, tmpSettings\n})\n","import Globals from '../../Globals';\nimport { Settings } from '../../models/Settings';\n\n// Used to store settings. They will be saved to file.\nexport default function reducer(state = new Settings(), action: any) {\n  var newSettings = { ...state };\n  switch (action.type) {\n    case \"LOAD_SETTINGS\":\n      newSettings = JSON.parse(localStorage.getItem(Globals.storeFile)!).settings;\n      break;\n    case \"SET_KEY_VAL\":\n      var key = action.key;\n      var val = action.val;\n      switch (key) {\n        case 'theme': {\n          document.body.classList.forEach((val) => {\n            if (/theme/.test(val)) {\n              document.body.classList.remove(val);\n            }\n          });\n          document.body.classList.toggle(`theme${val}`, true);\n          break;\n        }\n      }\n\n      (newSettings as any)[key] = val;\n      localStorage.setItem(Globals.storeFile, JSON.stringify({ settings: newSettings }));\n      break;\n    // @ts-ignore\n    case \"DEFAULT_SETTINGS\":\n      newSettings = new Settings();\n      break;\n    // eslint-disable-next-line\n    default:\n      if (Object.keys(newSettings).length === 0) {\n        newSettings = new Settings();\n      }\n      const defaultSettings = new Settings();\n      Object.keys(defaultSettings).forEach(key => {\n        if ((newSettings as any)[key] === undefined) {\n          (newSettings as any)[key] = (defaultSettings as any)[key];\n        }\n      });\n  }\n  return newSettings;\n}\n","import { TmpSettings } from \"../../models/TmpSettings\";\n\n// Used to store temp settings in RAM. They will not be saved to file.\nexport default function reducer(state = new TmpSettings(), action: any) {\n  var newState = { ...state };\n  var key = action.key;\n  var val = action.val;\n  (newState as any)[key] = val;\n  switch (action.type) {\n    case \"TMP_SET_KEY_VAL\": {\n      return newState;\n    }\n    default:\n      break;\n  }\n  return state;\n}\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, IonList, IonItem, IonRange, IonIcon, IonLabel, IonToggle, IonButton, IonAlert, IonSelect, IonSelectOption, IonToast, withIonLifeCycle } from '@ionic/react';\nimport { connect } from 'react-redux';\nimport { RouteComponentProps } from 'react-router-dom';\nimport Globals from '../Globals';\nimport { helpCircle, text, barcode, colorPalette, shareSocial, bug, download, informationCircle } from 'ionicons/icons';\nimport './SettingsPage.css';\nimport PackageInfos from '../../package.json';\nimport { Settings } from '../models/Settings';\n\ninterface StateProps {\n  showFontLicense: boolean;\n  showClearAlert: boolean;\n  showToast: boolean;\n  toastMessage: string;\n}\n\ninterface Props {\n  dispatch: Function;\n  hasAppLog: boolean;\n  theme: number;\n  uiFontSize: number;\n  settings: Settings;\n  voiceURI: string;\n  speechRate: number;\n  mainVersion: string | null;\n  cbetaOfflineDbMode: boolean;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n  label: string;\n}> { }\n\nclass _SettingsPage extends React.Component<PageProps, StateProps> {\n  constructor(props: any) {\n    super(props);\n\n    this.state = {\n      showFontLicense: false,\n      showClearAlert: false,\n      showToast: false,\n      toastMessage: '',\n    };\n  }\n\n  ionViewWillEnter() {\n  }\n\n  async updateData() {\n  }\n\n  render() {\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonTitle className='uiFont'>設定</IonTitle>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          <IonList>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={barcode} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>手機條碼：{this.props.settings.cardNo}</IonLabel>\n              <IonButton fill='outline' shape='round' slot='end' size='large' className='uiFont' onClick={e => {\n                Globals.logout(this.props.dispatch);\n                this.setState({showToast: true, toastMessage: '登出成功！'})\n              }}>登出</IonButton>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={shareSocial} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont' onClick={async e => {\n                // Disable app update for Mac App Store submission.\n                /*\n                const hasUpdate = await Globals.updateApp();\n\n                if (!hasUpdate) {\n                  this.setState({ showToast: true, toastMessage: 'App 已是最新版' });\n                }*/\n              }}>PWA 版本: <a href=\"https://github.com/MrMYHuang/twei#history\" target=\"_new\">{PackageInfos.pwaVersion}</a></IonLabel>\n              <IonButton fill='outline' shape='round' slot='end' size='large' className='uiFont' onClick={e => {\n                this.props.dispatch({\n                  type: \"TMP_SET_KEY_VAL\",\n                  key: 'shareTextModal',\n                  val: {\n                    show: true,\n                    text: window.location.origin,\n                  },\n                });\n              }}>分享</IonButton>\n            </IonItem>\n            <IonItem hidden={!this.props.mainVersion}>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={informationCircle} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>Backend app版本: {this.props.mainVersion}</IonLabel>\n              {/*<IonButton fill='outline' shape='round' slot='end' size='large' className='uiFont' onClick={e => {\n              }}>分享</IonButton>*/}\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={bug} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'><a href=\"https://github.com/MrMYHuang/twei#report\" target=\"_new\">啟用 app 異常記錄</a></IonLabel>\n              <IonToggle slot='end' checked={this.props.hasAppLog} onIonChange={e => {\n                const isChecked = e.detail.checked;\n\n                if (this.props.hasAppLog === isChecked) {\n                  return;\n                }\n\n                isChecked ? Globals.enableAppLog() : Globals.disableAppLog();\n                this.props.dispatch({\n                  type: \"SET_KEY_VAL\",\n                  key: 'hasAppLog',\n                  val: isChecked\n                });\n              }} />\n            </IonItem>\n            <IonItem hidden={!this.props.hasAppLog}>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={bug} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>回報 app 異常記錄</IonLabel>\n              <IonButton fill='outline' shape='round' slot='end' size='large' className='uiFont' onClick={e => {\n                window.open(`mailto:myh@live.com?subject=台灣發票異常記錄回報&body=${encodeURIComponent(\"問題描述(建議填寫)：\\n\\n瀏覽器：\" + navigator.userAgent + \"\\n\\nApp版本：\" + PackageInfos.pwaVersion + \"\\n\\nApp設定：\" + JSON.stringify(this.props.settings) + \"\\n\\nLog：\\n\" + Globals.getLog())}`);\n              }}>回報</IonButton>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={download} slot='start' />\n              <div className='contentBlock'>\n                <div style={{ flexDirection: 'column' }}>\n                  <IonLabel className='ion-text-wrap uiFont'>App 設定</IonLabel>\n                  <div style={{ textAlign: 'right' }}>\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={async (e) => {\n                      const settingsJsonUri = `data:text/json;charset=utf-8,${encodeURIComponent(localStorage.getItem(Globals.storeFile) || '')}`;\n                      const a = document.createElement('a');\n                      a.href = settingsJsonUri;\n                      a.download = Globals.storeFile;\n                      a.click();\n                      a.remove();\n                    }}>匯出</IonButton>\n                    <input id='importJsonInput' type='file' accept='.json' style={{ display: 'none' }} onChange={async (ev) => {\n                      const file = ev.target.files?.item(0);\n                      const fileText = await file?.text() || '';\n                      try {\n                        // JSON text validation.\n                        JSON.parse(fileText);\n                        localStorage.setItem(Globals.storeFile, fileText);\n                        this.props.dispatch({ type: 'LOAD_SETTINGS' });\n                        this.updateData();\n                      } catch (e) {\n                        console.error(e);\n                        console.error(new Error().stack);\n                      }\n                      (document.getElementById('importJsonInput') as HTMLInputElement).value = '';\n                    }} />\n\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={(e) => {\n                      (document.querySelector('#importJsonInput') as HTMLInputElement).click();\n                    }}>匯入</IonButton>\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={(e) => {\n                      this.setState({ showClearAlert: true });\n                    }}>重置</IonButton>\n                    <IonAlert\n                      cssClass='uiFont'\n                      isOpen={this.state.showClearAlert}\n                      backdropDismiss={false}\n                      onDidPresent={(ev) => {\n                      }}\n                      header={'重置會還原app設定預設值並清除書籤、離線資料檔！確定重置？'}\n                      buttons={[\n                        {\n                          text: '取消',\n                          cssClass: 'primary uiFont',\n                          handler: (value) => {\n                            this.setState({\n                              showClearAlert: false,\n                            });\n                          },\n                        },\n                        {\n                          text: '重置',\n                          cssClass: 'secondary uiFont',\n                          handler: async (value) => {\n                            await Globals.clearAppData();\n                            this.props.dispatch({ type: 'DEFAULT_SETTINGS' });\n                            while (document.body.classList.length > 0) {\n                              document.body.classList.remove(document.body.classList.item(0)!);\n                            }\n                            document.body.classList.toggle(`theme${this.props.theme}`, true);\n                            this.setState({ showClearAlert: false, showToast: true, toastMessage: \"清除成功!\" });\n                          },\n                        }\n                      ]}\n                    />\n                  </div>\n                </div>\n              </div>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={colorPalette} slot='start' />\n              <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['theme']}</IonLabel>\n              <IonSelect slot='end'\n                value={+this.props.theme}\n                className='uiFont'\n                interface='popover'\n                interfaceOptions={{ cssClass: 'tweithemes' }}\n                onIonChange={e => {\n                  const value = +e.detail.value;\n                  // Important! Because it can results in rerendering of this component but\n                  // store states (this.props.theme) of this component is not updated yet! And IonSelect value will be changed\n                  // back to the old value and onIonChange will be triggered again!\n                  // Thus, we use this check to ignore this invalid change.\n                  if (+this.props.theme === value) {\n                    return;\n                  }\n\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'theme',\n                    val: value,\n                  });\n                }}>\n                <IonSelectOption className='uiFont cbeta' value={0}>綠底</IonSelectOption>\n                <IonSelectOption className='uiFont dark' value={1}>暗色</IonSelectOption>\n                <IonSelectOption className='uiFont light' value={2}>亮色</IonSelectOption>\n                <IonSelectOption className='uiFont oldPaper' value={3}>舊書</IonSelectOption>\n                <IonSelectOption className='uiFont marble' value={4}>大理石</IonSelectOption>\n              </IonSelect>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={text} slot='start' />\n              <div className=\"contentBlock\">\n                <div style={{ flexDirection: \"column\" }}>\n                  <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings['uiFontSize']}: {this.props.uiFontSize}</IonLabel>\n                  <IonRange min={12} max={64} pin={true} snaps={true} value={this.props.uiFontSize} onIonChange={e => {\n                    this.props.dispatch({\n                      type: \"SET_KEY_VAL\",\n                      key: 'uiFontSize',\n                      val: e.detail.value,\n                    });\n                    Globals.updateCssVars(this.props.settings);\n                  }} />\n                </div>\n              </div>\n            </IonItem>\n            <IonItem>\n              <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n              <IonIcon icon={helpCircle} slot='start' />\n              <div className='uiFont'>\n                <div>關於</div>\n                <div><a href=\"https://github.com/MrMYHuang/twei#web-app\" target=\"_new\">程式安裝說明</a></div>\n                <div><a href=\"https://github.com/MrMYHuang/twei\" target=\"_new\">操作說明與開放原始碼</a></div>\n                <div>作者: Meng-Yuan Huang</div>\n                <div><a href=\"mailto:myh@live.com\" target=\"_new\">myh@live.com</a></div>\n              </div>\n            </IonItem>\n          </IonList>\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage >\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n    hasAppLog: state.settings.hasAppLog,\n    theme: state.settings.theme,\n    uiFontSize: state.settings.uiFontSize,\n    speechRate: state.settings.speechRate,\n    bookmarks: state.settings.bookmarks,\n    voiceURI: state.settings.voiceURI,\n    mainVersion: state.tmpSettings.mainVersion,\n  }\n};\n\nconst SettingsPage = withIonLifeCycle(_SettingsPage);\n\nexport default connect(\n  mapStateToProps,\n)(SettingsPage);\n","import axios from 'axios';\nimport qs from 'qs';\nimport { CarrierInvChk, CarrierInvChkDetail } from './models/CarrierInvChk';\nimport { CarrierInvDetail } from './models/CarrierInvDetail';\nimport { QryWinningList } from './models/QryWinningList';\n\nconst eInvUrl = 'https://q6zto4yhdh.execute-api.ap-northeast-1.amazonaws.com';\n\nconst axiosInstance = axios.create({\n    baseURL: eInvUrl,\n    timeout: 10000,\n    headers: {\n        'content-type': 'application/x-www-form-urlencoded',\n    }\n});\n\nasync function qryWinningList(lookupDate: string) {\n    const date = new Date(lookupDate);\n    const month = date.getMonth() + 1;\n    const invTerm = +`${(date.getFullYear() - 1911)}${((month % 2) === 0 ? month : month + 1).toString().padStart(2, '0')}`;\n    try {\n        const res = await axiosInstance.post(`${eInvUrl}/invapp/InvApp`, qs.stringify({\n            version: 0.2,\n            action: 'QryWinningList',\n            invTerm: invTerm,\n            UUID: '593ee92f-2543-404d-9f24-88f7771cc94a',\n        }));\n        return res.data as QryWinningList;\n    } catch (error) {\n        throw (error);\n    }\n}\n\nfunction carrierInvChkDetailDate(detail: CarrierInvChkDetail) {\n    return new Date(`${detail.invDate.year + 1911}/${detail.invDate.month}/${detail.invDate.date} ${detail.invoiceTime}`);\n}\n\nfunction findMonthStartDateEndDate(date: string) {\n    const d = new Date(date);\n    const endDate = new Date(d.getFullYear(), d.getMonth() + 1, 0);\n    return {\n        startDate: `${d.getFullYear()}/${(d.getMonth() + 1).toString().padStart(2, '0')}/01`,\n        endDate: `${d.getFullYear()}/${(d.getMonth() + 1).toString().padStart(2, '0')}/${endDate.getDate().toString().padStart(2, '0')}`,\n    }\n}\n\nasync function carrierInvChk(cardNo: string, cardEncrypt: string, lookupDate: string, isLogin: boolean = false) {\n    try {\n        const endPoint = isLogin ? '/twei/login' : '/invServ/InvServ';\n        const now = Math.ceil((new Date()).valueOf() / 1000);\n        const dates = findMonthStartDateEndDate(lookupDate);\n        const res = await axiosInstance.post(`${eInvUrl}${endPoint}`, qs.stringify({\n            version: 0.5,\n            cardType: '3J0002',\n            cardNo: cardNo,\n            action: 'carrierInvChk',\n            startDate: dates.startDate,\n            endDate: dates.endDate,\n            onlyWinningInv: 'N',\n            uuid: '593ee92f-2543-404d-9f24-88f7771cc94a',\n            timeStamp: now + 95,\n            expTimeStamp: now + 95 * 3,\n            cardEncrypt: cardEncrypt,\n        }));\n        if (isLogin) {\n            throw (new Error('LOGIN SUCCESS'));\n        }\n\n        let data = res.data as CarrierInvChk;\n        \n        if (+data.code !== 200) {\n          throw (new Error(`${data.code}: ${data.msg}`));\n        }\n\n        data.details = data.details.sort((a, b) => +carrierInvChkDetailDate(a) - +carrierInvChkDetailDate(b));\n        return data;\n    } catch (error) {\n        throw (error);\n    }\n}\n\nasync function carrierInvDetail(cardNo: string, cardEncrypt: string, invNum: string, invDate: string) {\n    try {\n        const now = Math.ceil((new Date()).valueOf() / 1000);\n        const res = await axiosInstance.post(`${eInvUrl}/invServ/InvServ`, qs.stringify({\n            version: 0.5,\n            cardType: '3J0002',\n            cardNo: cardNo,\n            action: 'carrierInvDetail',\n            invNum: invNum,\n            invDate: invDate,\n            uuid: '593ee92f-2543-404d-9f24-88f7771cc94a',\n            timeStamp: now + 95,\n            expTimeStamp: now + 95 * 3,\n            cardEncrypt: cardEncrypt,\n        }));\n        const data = res.data as CarrierInvDetail;\n        return data;\n    } catch (error) {\n        throw (error);\n    }\n}\n\nconst Apis = {\n    qryWinningList,\n    carrierInvChk,\n    carrierInvDetail,\n};\n\nexport default Apis;","const sample = {\n    \"v\": \"0.5\",\n    \"code\": 200,\n    \"msg\": \"執行成功\",\n    \"onlyWinningInv\": \"N\",\n    \"details\": [\n        {\n            \"rowNum\": 1,\n            \"invNum\": \"QE12345678\",\n            \"cardType\": \"3J0002\",\n            \"cardNo\": \"/0TOIJ2R\",\n            \"sellerName\": \"公司\",\n            \"invStatus\": \"已確認\",\n            \"invDonatable\": true,\n            \"amount\": \"49\",\n            \"invPeriod\": \"11008\",\n            \"donateMark\": 0,\n            \"invDate\": {\n                \"year\": 100,\n                \"month\": 3,\n                \"date\": 1,\n                \"day\": 4,\n                \"hours\": 0,\n                \"minutes\": 0,\n                \"seconds\": 0,\n                \"time\": 1918088800000,\n                \"timezoneOffset\": -480\n            },\n            \"sellerBan\": \"12345678\",\n            \"sellerAddress\": \"台北市中山區\",\n            \"invoiceTime\": \"01:12:34\",\n            \"buyerBan\": \"\",\n            \"currency\": \"\"\n        },\n    ]\n};\nexport type CarrierInvChkDetail = typeof sample.details[0];\nexport type CarrierInvChkDetails = typeof sample.details;\nexport type CarrierInvChk = typeof sample;\n\nexport enum WinningStatus {\n    Super,\n    Special,\n    First,\n    Second,\n    Third,\n    Forth,\n    Fifth,\n    Sixth,\n    SixthEx,\n    NoAward,\n    NotYet,\n}\n\nexport interface CarrierInvChkDetailExt extends CarrierInvChkDetail {\n    winningStatus: WinningStatus;\n}\n\nexport function winningStatusToString(status: WinningStatus) {\n    switch (status) {\n        case WinningStatus.Super:\n            return '1,000萬';\n        case WinningStatus.Special:\n            return '200萬';\n        case WinningStatus.First:\n            return '20萬';\n        case WinningStatus.Second:\n            return '4萬';\n        case WinningStatus.Third:\n            return '1萬';\n        case WinningStatus.Forth:\n            return '4千';\n        case WinningStatus.Fifth:\n            return '1千';\n        case WinningStatus.Sixth:\n            return '2百';\n        case WinningStatus.SixthEx:\n            return '2百';\n        case WinningStatus.NoAward:\n            return '未中獎';\n        default:\n            return '未開獎';\n    }\n}","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonToolbar, withIonLifeCycle, IonButton, IonList, IonItem, IonLabel, IonLoading, IonToast, IonTitle, IonInfiniteScroll, IonInfiniteScrollContent, IonAlert, IonInput, IonDatetime } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { Settings } from '../models/Settings';\nimport { TmpSettings } from '../models/TmpSettings';\nimport './EInvoiceListPage.css';\nimport Apis from '../Apis';\nimport { CarrierInvChkDetailExt, WinningStatus, winningStatusToString } from '../models/CarrierInvChk';\nimport Globals from '../Globals';\n\ninterface Props {\n  dispatch: Function;\n  tmpSettings: TmpSettings;\n  settings: Settings;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  path: string;\n  tab: string;\n}> { }\n\ninterface State {\n  dataParts: CarrierInvChkDetailExt[];\n  dateSel: string,\n  popover: any;\n  isScrollOn: boolean;\n  fetchError: boolean;\n  showToast: boolean;\n  toastMessage: string;\n  showConfrimSaveFormAlert: boolean;\n  cardNo: string;\n  cardEncrypt: string;\n}\n\nclass _EInvoiceListPage extends React.Component<PageProps, State> {\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      dataParts: [],\n      dateSel: new Date().toString(),\n      popover: {\n        show: false,\n        event: null,\n      },\n      isScrollOn: false,\n      fetchError: false,\n      showConfrimSaveFormAlert: false,\n      showToast: false,\n      toastMessage: '',\n      cardNo: '',\n      cardEncrypt: '',\n    }\n  }\n\n  async ionViewWillEnter() {\n    //console.log(`${this.props.match.url} will enter`);\n\n    if (this.props.settings.cardEncrypt !== '') {\n      this.fetchDataAndShow();\n    }\n  }\n\n  /*\n  componentDidMount() {\n    //console.log(`did mount: ${this.props.match.url}`);\n  }\n  \n  componentWillUnmount() {\n    console.log(`${this.props.match.url} unmount`);\n  }\n\n  ionViewWillLeave() {\n  }\n  */\n\n  async fetchDataAndShow() {\n    this.setIsLoading(true);\n    await this.fetchData();\n    await this.showDataPageByPage(true);\n    this.setIsLoading(false);\n  }\n\n  async fetchData() {\n    const res2 = await Apis.qryWinningList(this.state.dateSel);\n    if (+res2.code === 200) {\n      this.props.dispatch({\n        type: \"TMP_SET_KEY_VAL\",\n        key: 'qryWinningList',\n        val: res2,\n      });\n    } else {\n      if (+res2.code === 901) {\n        this.props.dispatch({\n          type: \"TMP_SET_KEY_VAL\",\n          key: 'qryWinningList',\n          val: undefined,\n        });\n      } else {\n        throw (new Error(`${res2.code}: ${res2.msg}`));\n      }\n    }\n\n    try {\n      const res = await Apis.carrierInvChk(this.props.settings.cardNo, this.props.settings.cardEncrypt, this.state.dateSel);\n      let details = res.details as CarrierInvChkDetailExt[];\n      details.forEach((v, i) => {\n        details[i].winningStatus = this.calculateInvoiceWinningStatus(v.invNum);\n      })\n      this.props.dispatch({\n        type: \"TMP_SET_KEY_VAL\",\n        key: 'carrierInvChkDetailsExt',\n        val: details.sort((a, b) => a.winningStatus - b.winningStatus),\n      });\n    } catch (error) {\n      this.props.dispatch({\n        type: \"TMP_SET_KEY_VAL\",\n        key: 'carrierInvChkDetailsExt',\n        val: undefined,\n      });\n    }\n  }\n\n  setIsLoading(value: boolean) {\n    this.props.dispatch({\n      type: \"TMP_SET_KEY_VAL\",\n      key: 'isLoadingData',\n      val: value,\n    });\n  }\n\n  page = 0;\n  rows = 20;\n  async showDataPageByPage(fromStart: boolean = false) {\n    if (fromStart) {\n      this.page = 0;\n    }\n\n    //console.log(`Loading page ${this.page}`);\n\n    const data = this.props.tmpSettings.carrierInvChkDetailsExt;\n    const dataParts = data.slice(this.page * this.rows, (this.page + 1) * this.rows);\n\n    this.page += 1;\n    this.setState({\n      fetchError: false, dataParts: fromStart ? dataParts : [...this.state.dataParts, ...dataParts],\n      isScrollOn: dataParts.length === this.rows,\n    });\n\n    return true;\n  }\n\n  calculateInvoiceWinningStatus(invNum: string) {\n    invNum = invNum.substring(2);\n    const winningList = this.props.tmpSettings.qryWinningList;\n    if (winningList == null) {\n      return WinningStatus.NotYet;\n    }\n\n    const firstPrizeNos = [\n      winningList.firstPrizeNo1, winningList.firstPrizeNo2, winningList.firstPrizeNo3,\n      winningList.firstPrizeNo4, winningList.firstPrizeNo5, winningList.firstPrizeNo6,\n      winningList.firstPrizeNo7, winningList.firstPrizeNo8, winningList.firstPrizeNo9,\n      winningList.firstPrizeNo10,\n    ];\n    const sixthPrizeNos = [\n      winningList.sixthPrizeNo1, winningList.sixthPrizeNo2, winningList.sixthPrizeNo3,\n      winningList.sixthPrizeNo4, winningList.sixthPrizeNo5, winningList.sixthPrizeNo6,\n    ];\n    if (invNum === winningList.superPrizeNo) {\n      return WinningStatus.Super;\n    } else if ([winningList.spcPrizeNo, winningList.spcPrizeNo2, winningList.spcPrizeNo3].some(no => invNum === no)) {\n      return WinningStatus.Special;\n    } else if (firstPrizeNos.some(no => invNum === no)) {\n      return WinningStatus.First;\n    } else if (firstPrizeNos.some(no => invNum.substring(1) === no.substring(1))) {\n      return WinningStatus.Second;\n    } else if (firstPrizeNos.some(no => invNum.substring(2) === no.substring(2))) {\n      return WinningStatus.Third;\n    } else if (firstPrizeNos.some(no => invNum.substring(3) === no.substring(3))) {\n      return WinningStatus.Forth;\n    } else if (firstPrizeNos.some(no => invNum.substring(4) === no.substring(4))) {\n      return WinningStatus.Fifth;\n    } else if (firstPrizeNos.some(no => invNum.substring(5) === no.substring(5))) {\n      return WinningStatus.Sixth;\n    } else if (sixthPrizeNos.some(no => invNum.substring(5) === no)) {\n      return WinningStatus.SixthEx;\n    } else {\n      return WinningStatus.NoAward;\n    }\n  }\n\n  getRows() {\n    let rows = Array<object>();\n    this.state.dataParts.forEach((item: CarrierInvChkDetailExt, index: number) => {\n      const row = <IonItem button={true} key={`item` + item.invNum}\n        onClick={async event => {\n          const invDate = `${item.invDate.year + 1911}-${item.invDate.month.toString().padStart(2, '0')}-${item.invDate.date.toString().padStart(2, '0')}`;\n          this.props.history.push(`${Globals.pwaUrl}/eInvoice/${item.invNum}/${invDate}`);\n        }}>\n        <div tabIndex={0}></div>{/* Workaround for macOS Safari 14 bug. */}\n        <div className='winningStatus'>\n          <IonLabel className='ion-text-wrap uiFont' key={`winLabel_` + index}>\n            {winningStatusToString(item.winningStatus)}\n          </IonLabel>\n        </div>\n        <div className='listItem'>\n          <div>\n            <IonLabel className='ion-text-wrap uiFont' key={`invDataLabel_` + index}>\n              {item.invDate.month.toString().padStart(2, '0')}/{item.invDate.date.toString().padStart(2, '0')} &nbsp;\n              {item.invNum} &nbsp;\n              {item.amount}元\n            </IonLabel>\n          </div>\n          <div>\n            <IonLabel className='ion-text-wrap uiFont' key={`sellerLabel_` + index}>\n              {item.sellerName}\n            </IonLabel>\n          </div>\n        </div>\n      </IonItem>;\n      rows.push(row);\n    });\n    return rows;\n  }\n\n  render() {\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonTitle className='uiFont'>發票</IonTitle>\n            <IonDatetime slot='end' className='uiFont'\n              displayFormat='YYYY年MM月'\n              display-timezone='Asia/Taipei'\n              doneText='確定'\n              cancelText='取消'\n              value={this.state.dateSel}\n              onIonChange={async e => {\n                this.setState({ dateSel: e.detail.value || '' });\n                await this.fetchDataAndShow();\n              }} >\n            </IonDatetime>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent style={{ textAlign: 'center' }}>\n          {\n            this.props.tmpSettings.isLoadingData ?\n              <IonLoading\n                cssClass='uiFont'\n                isOpen={this.props.tmpSettings.isLoadingData}\n                message={'載入中...'}\n              />\n              :\n              this.props.settings.cardEncrypt === '' ?\n                <>\n                  <div className='LoginBlock'>\n                    <IonLabel className='uiFont'>手機條碼</IonLabel>\n                    <IonInput className='uiFont IonInput' value={this.state.cardNo} placeholder='/ABC+123' onIonChange={(e) => {\n                      this.setState({ cardNo: e.detail.value || '' });\n                    }}></IonInput>\n                  </div>\n\n                  <div className='LoginBlock'>\n                    <IonLabel className='uiFont'>驗證碼</IonLabel>\n                    <IonInput className='uiFont IonInput' type='password' value={this.state.cardEncrypt} onIonChange={(e) => {\n                      this.setState({ cardEncrypt: e.detail.value || '' });\n                    }}></IonInput>\n\n                    <IonButton fill='outline' shape='round' size='large' className='uiFont' onClick={e => {\n                      this.setState({ showConfrimSaveFormAlert: true });\n                    }}>登入</IonButton>\n                  </div>\n                </>\n                :\n                <>\n                  <IonList>\n                    {this.getRows()}\n                    <IonInfiniteScroll threshold=\"100px\"\n                      disabled={!this.state.isScrollOn}\n                      onIonInfinite={(ev: CustomEvent<void>) => {\n                        this.showDataPageByPage();\n                        (ev.target as HTMLIonInfiniteScrollElement).complete();\n                      }} >\n                      <IonInfiniteScrollContent\n                        loadingText=\"載入中...\">\n                      </IonInfiniteScrollContent>\n                    </IonInfiniteScroll>\n                  </IonList>\n                  <IonLabel>中獎資訊僅供參考。若有錯誤恕不負責。</IonLabel>\n                </>\n          }\n\n          <IonAlert\n            cssClass='uiFont'\n            isOpen={this.state.showConfrimSaveFormAlert}\n            backdropDismiss={false}\n            header={'警告！請勿在公用電腦登入此 app，因為登入後驗證碼將以明碼存至此裝置，會有外洩的問題。請在個人裝置使用此 app 或至設定頁登出。'}\n            buttons={[\n              {\n                text: '取消',\n                cssClass: 'secondary uiFont',\n                handler: (value) => {\n                  this.setState({\n                    showConfrimSaveFormAlert: false,\n                  });\n                },\n              },\n\n              {\n                text: '登入',\n                cssClass: 'primary uiFont',\n                handler: async (value) => {\n                  this.setState({\n                    showConfrimSaveFormAlert: false,\n                  });\n\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'cardNo',\n                    val: this.state.cardNo,\n                  });\n\n                  this.props.dispatch({\n                    type: \"SET_KEY_VAL\",\n                    key: 'cardEncrypt',\n                    val: this.state.cardEncrypt,\n                  });\n\n                  try {\n                    this.setIsLoading(true);\n                    await Apis.carrierInvChk(this.props.settings.cardNo, this.props.settings.cardEncrypt, this.state.dateSel, true);\n                  } catch (error) {\n                    this.setIsLoading(false);\n                    if (error.message === 'LOGIN SUCCESS') {\n                      this.setState({ toastMessage: '登入成功！', showToast: true });\n                      await this.fetchDataAndShow();\n                    } else {\n                      Globals.logout(this.props.dispatch);\n                      this.setState({ toastMessage: '登入失敗，請檢察手機條碼與驗證碼！', showToast: true });\n                    }\n                  }\n                },\n              },\n            ]}\n          />\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage>\n    );\n  }\n};\n\nconst EInvoiceListPage = withIonLifeCycle(_EInvoiceListPage);\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    tmpSettings: state.tmpSettings,\n    settings: state.settings,\n  }\n};\n\n// const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(EInvoiceListPage);\n","import React from 'react';\nimport { IonButton, IonContent, IonItem, IonLabel, IonList, IonModal, IonToggle } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport Globals from '../Globals';\nimport * as qrcode from 'qrcode';\n\ninterface Props {\n  showModal: boolean;\n  text: string;\n  finish: Function;\n  settings: any;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  isAppSettingsExport: Array<boolean>;\n}\n\nclass _ShareTextModal extends React.Component<PageProps, State> {\n\n  constructor(props: any) {\n    super(props);\n    this.state = {\n      isAppSettingsExport: Array<boolean>(Object.keys(Globals.appSettings).length)\n    }\n  }\n\n  updateQrCode() {\n    const appSettingsExport = Object.keys(Globals.appSettings).filter((key, i) => this.state.isAppSettingsExport[i]).map((key, i) => {return {key: key, val: this.props.settings[key]};});\n    let appSettingsString: string | null = appSettingsExport.map(keyVal => `${keyVal.key}=${+keyVal.val}`).join(',');\n    appSettingsString = appSettingsString !== '' ? `settings=${appSettingsString}` : null;\n    let appUrl = this.props.text;\n    const hasQueryString = /\\?/.test(appUrl);\n    if (appSettingsString) {\n      appUrl += hasQueryString ? `&${appSettingsString}` : `?${appSettingsString}`;\n    }\n    \n    Globals.copyToClipboard(appUrl);\n    const qrcCanvas = document.getElementById('qrcCanvas');\n    qrcode.toCanvas(qrcCanvas, appUrl);\n    return qrcCanvas;\n  }\n\n  render() {\n    return (\n      <IonModal\n        isOpen={this.props.showModal}\n        cssClass='uiFont'\n        swipeToClose={true}\n        //presentingElement={router || undefined}\n        onWillPresent={() => {\n          let isAppSettingsExport: Array<boolean> = [];\n          for (let i = 0; i < this.state.isAppSettingsExport.length; i++) {\n            isAppSettingsExport.push(false);\n          }\n          this.setState({isAppSettingsExport: isAppSettingsExport});\n          this.updateQrCode();\n        }}\n        onDidDismiss={() => this.props.finish()}>\n        <IonContent>\n          <div style={{ display: 'flex', flexDirection: 'column', height: '100%', alignItems: 'center' }}>\n            <div>\n              <IonLabel className='uiFont'>此頁app連結已複製至剪貼簿！</IonLabel>\n            </div>\n            <div>\n              <IonLabel className='uiFont'>也可以使用QR Code分享:</IonLabel>\n            </div>\n            <div style={{ flexGrow: 1, flexShrink: 0, display: 'flex', alignItems: 'center', margin: 10 }}>\n              <canvas id='qrcCanvas' width='500' height='500' style={{ margin: '0px auto' }} />\n            </div>\n            <div>\n              <IonLabel className='uiFont'>包括app設定:</IonLabel>\n              <IonList>\n                {\n                  Object.keys(Globals.appSettings).map((key, i) =>\n                    <IonItem key={`appSettingExportItem_${i}`}>\n                      <IonLabel className='ion-text-wrap uiFont'>{Globals.appSettings[key]}</IonLabel>\n                      <IonToggle slot='end' onIonChange={e => {\n                        const isAppSettingsExport =  this.state.isAppSettingsExport;\n                        isAppSettingsExport[i] = e.detail.checked;\n                        this.setState({isAppSettingsExport: isAppSettingsExport});\n                        this.updateQrCode();\n                      }} />\n                    </IonItem>\n                  )\n                }\n              </IonList>\n            </div>\n            <div>\n              <IonButton fill='outline' shape='round' size='large' onClick={() => this.props.finish()}>關閉</IonButton>\n            </div>\n          </div>\n        </IonContent>\n      </IonModal>\n    );\n  }\n};\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    settings: state.settings,\n  }\n};\n\n//const mapDispatchToProps = {};\n\nexport default connect(\n  mapStateToProps,\n)(_ShareTextModal);\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, withIonLifeCycle, IonButton, IonList, IonItem, IonIcon, IonToast, IonLoading, IonLabel, IonListHeader } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport { Settings } from '../models/Settings';\nimport { TmpSettings } from '../models/TmpSettings';\n\nimport { arrowBack } from 'ionicons/icons';\nimport { CarrierInvDetail } from '../models/CarrierInvDetail';\nimport Apis from '../Apis';\n\ninterface Props {\n  dispatch: Function;\n  settings: Settings;\n  tmpSettings: TmpSettings;\n}\n\ninterface State {\n  carrierInvDetail: CarrierInvDetail | undefined;\n  showToast: boolean;\n  toastMessage: string;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n  invNum: string;\n  invDate: string;\n}> { }\n\nclass _DetailPage extends React.Component<PageProps, State> {\n  constructor(props: PageProps) {\n    super(props);\n    this.state = {\n      carrierInvDetail: undefined,\n      showToast: false,\n      toastMessage: '',\n    };\n\n    this.fetchData();\n  }\n\n  async ionViewWillEnter() {\n  }\n\n  async fetchData() {\n    this.setIsLoading(true);\n    const carrierInvDetail = await Apis.carrierInvDetail(\n      this.props.settings.cardNo,\n      this.props.settings.cardEncrypt,\n      this.props.match.params.invNum,\n      this.props.match.params.invDate.replaceAll('-', '/'),\n    );\n    this.setState({ carrierInvDetail: carrierInvDetail });\n    this.setIsLoading(false);\n  }\n\n  setIsLoading(value: boolean) {\n    this.props.dispatch({\n      type: \"TMP_SET_KEY_VAL\",\n      key: 'isLoadingData',\n      val: value,\n    });\n  }\n\n  render() {\n    const cid = this.state.carrierInvDetail;\n    return (\n      this.props.tmpSettings.isLoadingData ?\n        <IonLoading\n          cssClass='uiFont'\n          isOpen={this.props.tmpSettings.isLoadingData}\n          message={'載入中...'}\n        />\n        :\n        <IonPage>\n          <IonHeader>\n            <IonToolbar>\n              <IonButton fill=\"clear\" slot='start' onClick={e => this.props.history.goBack()}>\n                <IonIcon icon={arrowBack} slot='icon-only' />\n              </IonButton>\n\n              <IonTitle className='uiFont'>發票明細</IonTitle>\n\n            </IonToolbar>\n          </IonHeader>\n          <IonContent style={{ textAlign: 'center' }}>\n\n            <div className='ion-text-wrap uiFontX1_5' style={{ textAlign: 'left' }}>{cid?.sellerName}</div>\n\n            <div>\n              <IonLabel className='ion-text-wrap uiFontX1_5' style={{ color: 'red' }}>{cid?.invNum}</IonLabel>\n            </div>\n\n            <IonItem>\n              <IonLabel className='ion-text-wrap uiFontX0_7'>{cid?.invDate}&nbsp;{cid?.invoiceTime}</IonLabel>\n              <IonLabel className='ion-text-wrap uiFontX0_7' style={{ textAlign: 'right' }}>{this.props.settings.cardNo}</IonLabel>\n            </IonItem>\n\n            {\n              <IonList>\n                <IonListHeader lines='full' color='primary'>\n                  <IonLabel className='uiFont'>交易明細</IonLabel>\n                </IonListHeader>\n\n                <IonItem>\n                  <IonLabel className='ion-text-wrap uiFont'>營業人統編：{cid?.sellerBan}</IonLabel>\n                </IonItem>\n                <IonItem>\n                  <IonLabel className='ion-text-wrap uiFont'>門市地址：{cid?.sellerAddress}</IonLabel>\n                </IonItem>\n                <IonItem>\n                  <IonLabel slot='start' className='ion-text-wrap uiFont' style={{ fontWeight: 'bold' }}>品名(數量)</IonLabel>\n                  <IonLabel slot='end' className='ion-text-wrap uiFont' style={{ textAlign: 'right', fontWeight: 'bold' }}>小計</IonLabel>\n                </IonItem>\n                {\n                  cid?.details.map((v, i) =>\n                    <IonItem key={`item${i}`}>\n                      <IonLabel slot='start' className='ion-text-wrap uiFont'>{v.description}({v.quantity})</IonLabel>\n                      <IonLabel slot='end' className='ion-text-wrap uiFont' style={{ textAlign: 'right' }}>{v.amount}</IonLabel>\n                    </IonItem>\n                  )\n                }\n                <IonItem>\n                  <IonLabel slot='end' className='ion-text-wrap uiFont' style={{ textAlign: 'right' }}>\n                    合計：{cid?.amount}元\n                  </IonLabel>\n                </IonItem>\n              </IonList>\n            }\n\n            <IonToast\n              cssClass='uiFont'\n              isOpen={this.state.showToast}\n              onDidDismiss={() => this.setState({ showToast: false })}\n              message={this.state.toastMessage}\n              duration={2000}\n            />\n          </IonContent>\n        </IonPage>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    tmpSettings: state.tmpSettings,\n    settings: state.settings\n  }\n};\n\n//const mapDispatchToProps = {};\n\nconst DetailPage = withIonLifeCycle(_DetailPage);\n\nexport default connect(\n  mapStateToProps,\n)(DetailPage);\n","import React from 'react';\nimport { IonContent, IonHeader, IonPage, IonTitle, IonToolbar, withIonLifeCycle, IonButton, IonIcon, IonToast, IonLoading, IonLabel, IonDatetime } from '@ionic/react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport { Settings } from '../models/Settings';\nimport { TmpSettings } from '../models/TmpSettings';\n\nimport { arrowBack } from 'ionicons/icons';\nimport Apis from '../Apis';\nimport './WinningListPage.css';\n\ninterface Props {\n  dispatch: Function;\n  settings: Settings;\n  tmpSettings: TmpSettings;\n}\n\ninterface State {\n  dateSel: string;\n  showToast: boolean;\n  toastMessage: string;\n}\n\ninterface PageProps extends Props, RouteComponentProps<{\n  tab: string;\n}> { }\n\nclass _WinningListPage extends React.Component<PageProps, State> {\n  maxDate: Date;\n  constructor(props: PageProps) {\n    super(props);\n\n    const currentDate = new Date();\n    const year = currentDate.getFullYear();\n    const month = currentDate.getMonth() + 1;\n    this.maxDate = new Date(\n      year,\n      (month % 2) === 0 ? month - 3 : month - 2,\n      1);\n\n    this.state = {\n      dateSel: this.maxDate.toString(),\n      showToast: false,\n      toastMessage: '',\n    };\n  }\n\n  ionViewWillEnter() {\n    this.fetchData();\n  }\n\n  async fetchData() {\n    this.setIsLoading(true);\n    const res2 = await Apis.qryWinningList(this.state.dateSel);\n    if (+res2.code === 200) {\n      this.props.dispatch({\n        type: \"TMP_SET_KEY_VAL\",\n        key: 'qryWinningList',\n        val: res2,\n      });\n    } else {\n      if (+res2.code === 901) {\n        this.props.dispatch({\n          type: \"TMP_SET_KEY_VAL\",\n          key: 'qryWinningList',\n          val: undefined,\n        });\n      } else {\n        throw (new Error(`${res2.code}: ${res2.msg}`));\n      }\n    }\n    this.setIsLoading(false);\n  }\n\n  setIsLoading(value: boolean) {\n    this.props.dispatch({\n      type: \"TMP_SET_KEY_VAL\",\n      key: 'isLoadingData',\n      val: value,\n    });\n  }\n\n  render() {\n    const qwl = this.props.tmpSettings.qryWinningList!;\n    return (\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonButton fill=\"clear\" slot='start' onClick={e => this.props.history.goBack()}>\n              <IonIcon icon={arrowBack} slot='icon-only' />\n            </IonButton>\n\n            <IonTitle className='uiFont'>開獎號碼</IonTitle>\n\n            <IonDatetime slot='end' className='uiFont'\n              displayFormat='YYYY年MMM月'\n              monthValues='1, 3, 5, 7, 9, 11'\n              monthShortNames='01-02, 01-02, 03-04, 03-04, 05-06, 05-06, 07-08, 07-08, 09-10, 09-10, 11-12, 11-12'\n              display-timezone='Asia/Taipei'\n              doneText='確定'\n              cancelText='取消'\n              value={this.state.dateSel}\n              onIonChange={async e => {\n                this.setState({ dateSel: e.detail.value || '' });\n                await this.fetchData();\n              }}>\n            </IonDatetime>\n          </IonToolbar>\n        </IonHeader>\n        <IonContent style={{ textAlign: 'center' }}>\n\n          {\n            this.props.tmpSettings.isLoadingData || qwl == null ?\n              <IonLoading\n                cssClass='uiFont'\n                isOpen={this.props.tmpSettings.isLoadingData}\n                message={'載入中...'}\n              />\n              :\n              <div className='table'>\n                <div className='row'>\n                  <IonLabel className='cell1'>特別獎</IonLabel>\n                  <div className='cell2'>\n                    <span className='uiFontX1_5 cellSpan'>{qwl.superPrizeNo}</span>\n                    <span className='uiFontX0_7'>8位數號碼與上列號碼相同者獎金1,000萬元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>特獎</div>\n                  <div className='cell2'>\n                    {\n                      [qwl.spcPrizeNo, qwl.spcPrizeNo2, qwl.spcPrizeNo3].filter(v => v !== '').map(v =>\n                        <span className='uiFontX1_5 cellSpan'>{v}</span>\n                      )\n                    }\n                    <span className='uiFontX0_7'>8位數號碼與上列號碼相同者獎金200萬元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>頭獎</div>\n                  <div className='cell2'>\n                    {\n                      [\n                        qwl.firstPrizeNo1, qwl.firstPrizeNo2, qwl.firstPrizeNo3,\n                        qwl.firstPrizeNo4, qwl.firstPrizeNo5, qwl.firstPrizeNo6,\n                        qwl.firstPrizeNo7, qwl.firstPrizeNo8, qwl.firstPrizeNo9,\n                        qwl.firstPrizeNo10,\n                      ].filter(v => v !== '').sort((a, b) => +a - +b).map(v =>\n                        <span className='uiFontX1_5 cellSpan'>{v}</span>\n                      )\n                    }\n                    <span className='uiFontX0_7'>8位數號碼與上列號碼相同者獎金20萬元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>二獎</div>\n                  <div className='cell2'>\n                    <span className='uiFontX0_7'>末7碼與頭獎相同者各得獎金4萬元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>三獎</div>\n                  <div className='cell2'>\n                    <span className='uiFontX0_7'>末6碼與頭獎相同者各得獎金1萬元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>四獎</div>\n                  <div className='cell2'>\n                    <span className='uiFontX0_7'>末5碼與頭獎相同者各得獎金4千元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>五獎</div>\n                  <div className='cell2'>\n                    <span className='uiFontX0_7'>末4碼與頭獎相同者各得獎金1千元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>六獎</div>\n                  <div className='cell2'>\n                    <span className='uiFontX0_7'>末3碼與頭獎相同者各得獎金2百元</span>\n                  </div>\n                </div>\n\n                <div className='row'>\n                  <div className='cell1'>增開六獎</div>\n                  <div className='cell2'>\n                    {\n                      [\n                        qwl.sixthPrizeNo1, qwl.sixthPrizeNo2, qwl.sixthPrizeNo3,\n                        qwl.sixthPrizeNo4, qwl.sixthPrizeNo5, qwl.sixthPrizeNo6,\n                      ].filter(v => v !== '').map(v =>\n                        <span className='uiFontX1_5 cellSpan'>{v}</span>\n                      )\n                    }\n                    <span className='uiFontX0_7'>末3碼與增開六獎相同者各得獎金2百元</span>\n                  </div>\n                </div>\n\n              </div>\n          }\n\n          <IonToast\n            cssClass='uiFont'\n            isOpen={this.state.showToast}\n            onDidDismiss={() => this.setState({ showToast: false })}\n            message={this.state.toastMessage}\n            duration={2000}\n          />\n        </IonContent>\n      </IonPage>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    tmpSettings: state.tmpSettings,\n    settings: state.settings\n  }\n};\n\n//const mapDispatchToProps = {};\n\nconst WinningListPage = withIonLifeCycle(_WinningListPage);\n\nexport default connect(\n  mapStateToProps,\n)(WinningListPage);\n","import React from 'react';\nimport { Redirect, Route, RouteComponentProps, withRouter } from 'react-router-dom';\nimport {\n  setupConfig,\n  IonApp,\n  IonIcon,\n  IonRouterOutlet,\n  IonTabBar,\n  IonTabButton,\n  IonTabs,\n  IonAlert,\n  IonToast,\n} from '@ionic/react';\nimport { IonReactRouter } from '@ionic/react-router';\nimport { connect, Provider } from 'react-redux';\nimport queryString from 'query-string';\nimport getSavedStore from './redux/store';\nimport { settings, receipt, trophy } from 'ionicons/icons';\n\n/* Core CSS required for Ionic components to work properly */\nimport '@ionic/react/css/core.css';\n\n/* Basic CSS for apps built with Ionic */\nimport '@ionic/react/css/normalize.css';\nimport '@ionic/react/css/structure.css';\nimport '@ionic/react/css/typography.css';\n\n/* Optional CSS utils that can be commented out */\nimport '@ionic/react/css/padding.css';\nimport '@ionic/react/css/float-elements.css';\nimport '@ionic/react/css/text-alignment.css';\nimport '@ionic/react/css/text-transformation.css';\nimport '@ionic/react/css/flex-utils.css';\nimport '@ionic/react/css/display.css';\n\n/* Theme variables */\nimport './theme/variables.css';\nimport SettingsPage from './pages/SettingsPage';\nimport Globals from './Globals';\nimport EInvoiceListPage from './pages/EInvoiceListPage';\nimport ShareTextModal from './components/ShareTextModal';\nimport { Settings } from './models/Settings';\nimport { TmpSettings } from './models/TmpSettings';\nimport DetailPage from './pages/DetailPage';\nimport WinningListPage from './pages/WinningListPage';\n\nconst electronBackendApi: any = (window as any).electronBackendApi;\n\nlet store = getSavedStore();\n/*\nclass DebugRouter extends IonReactRouter {\n  constructor(props: any) {\n    super(props);\n    console.log('initial history is: ', JSON.stringify(this.history, null, 2))\n    this.history.listen((location, action) => {\n      console.log(\n        `The current URL is ${location.pathname}${location.search}${location.hash}`\n      )\n      console.log(`The last navigation action was ${action}`, JSON.stringify(this.history, null, 2));\n    });\n  }\n}\n*/\n\nsetupConfig({\n  mode: 'md', // Use a consistent UI style across Android and iOS.\n  swipeBackEnabled: false,\n});\n\nexport var serviceWorkCallbacks = {\n  onSuccess: function (registration: ServiceWorkerRegistration) { },\n  onUpdate: function (registration: ServiceWorkerRegistration) { },\n};\n\ninterface Props {\n  dispatch: Function;\n  shareTextModal: any;\n  settings: Settings;\n  tmpSettings: TmpSettings;\n}\n\ninterface PageProps extends RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface AppOrigProps extends Props, RouteComponentProps<{\n  tab: string;\n  path: string;\n}> { }\n\ninterface State {\n  showToast: boolean;\n  toastMessage: string;\n  showUpdateAlert: boolean;\n  showRestoreAppSettingsToast: boolean;\n}\n\nclass _App extends React.Component<PageProps> {\n  render() {\n    return (\n      <Provider store={store}>\n        <AppOrig {...this.props} />\n      </Provider>\n    );\n  }\n}\n\nclass _AppOrig extends React.Component<AppOrigProps, State> {\n  registrationNew: ServiceWorkerRegistration | null;\n  originalAppSettingsStr: string | null | undefined;\n\n  constructor(props: any) {\n    super(props);\n    if (!this.props.settings.hasAppLog) {\n      Globals.disableAppLog();\n    }\n\n    electronBackendApi?.receive(\"fromMain\", (data: any) => {\n      switch (data.event) {\n        case 'version':\n          store.dispatch({\n            type: \"TMP_SET_KEY_VAL\",\n            key: 'mainVersion',\n            val: data.version,\n          });\n          break;\n      }\n    });\n    electronBackendApi?.send(\"toMain\", { event: 'ready' });\n\n    this.registrationNew = null;\n\n    // ----- Initializing UI settings -----\n    // Apply the theme setting.\n    while (document.body.classList.length > 0) {\n      document.body.classList.remove(document.body.classList.item(0)!);\n    }\n    document.body.classList.toggle(`theme${this.props.settings.theme}`, true);\n\n    // Modify UI settings from query string.\n    const queryParams = queryString.parse(this.props.location.search) as any;\n    if (queryParams.settings) {\n      this.originalAppSettingsStr = localStorage.getItem(Globals.storeFile);\n      (queryParams.settings as string).split(',').forEach(setting => {\n        const keyVal = setting.split('=');\n        this.props.dispatch({\n          type: \"SET_KEY_VAL\",\n          key: keyVal[0],\n          val: +keyVal[1],\n        });\n      });\n    }\n    Globals.updateCssVars(this.props.settings);\n\n    this.state = {\n      showUpdateAlert: false,\n      showRestoreAppSettingsToast: (queryParams.settings != null && this.originalAppSettingsStr != null) || false,\n      showToast: false,\n      toastMessage: '',\n    };\n\n    serviceWorkCallbacks.onUpdate = (registration: ServiceWorkerRegistration) => {\n      this.registrationNew = registration;\n      this.setState({ showUpdateAlert: true });\n    };\n\n    serviceWorkCallbacks.onSuccess = (registration: ServiceWorkerRegistration) => {\n    };\n\n    // Preload speechSynthesis.\n    if (typeof speechSynthesis !== 'undefined') {\n      speechSynthesis.getVoices();\n      speechSynthesis.cancel();\n    }\n\n    // Enable screen wake lock.\n    if ((navigator as any).wakeLock) {\n      this.wakeLockScreen();\n      document.addEventListener(\"visibilitychange\", async () => {\n        if (document.visibilityState === 'visible') {\n          this.wakeLockScreen();\n        } else {\n          this.wakeLockScreenRelease()\n        }\n      });\n    }\n\n    const dbOpenReq = indexedDB.open(Globals.tweiDb);\n    // Init store in indexedDB if necessary.\n    dbOpenReq.onupgradeneeded = function (event: IDBVersionChangeEvent) {\n      var db = (event.target as any).result;\n      db.createObjectStore('store');\n      console.log(`DB store created.`);\n    };\n  }\n\n  restoreAppSettings() {\n    localStorage.setItem(Globals.storeFile, this.originalAppSettingsStr!);\n    this.props.dispatch({ type: 'LOAD_SETTINGS' });\n    while (document.body.classList.length > 0) {\n      document.body.classList.remove(document.body.classList.item(0)!);\n    }\n    document.body.classList.toggle(`theme${this.props.settings.theme}`, true);\n    Globals.updateCssVars(this.props.settings);\n  }\n\n  // Prevent device from sleeping.\n  wakeLock: any;\n  async wakeLockScreen() {\n    try {\n      const wakeLock = (navigator as any).wakeLock;\n      if (wakeLock != null) {\n        this.wakeLock = await wakeLock.request('screen');\n        console.log('Screen wake lock is requested.');\n      } else {\n        console.error('navigator.wakeLock is undefined.');\n      }\n    } catch (err) {\n      // the wake lock request fails - usually system related, such low as battery\n      console.log(`${err.name}, ${err.message}`);\n      console.log(new Error().stack);\n    }\n  }\n\n  async wakeLockScreenRelease() {\n    if (this.wakeLock != null) {\n      await this.wakeLock.release();\n      this.wakeLock = null;\n      console.log('Screen wake lock is released.');\n    }\n  }\n\n  routeByQueryString() {\n    // This app uses client side routing. \n    // Without the first loading of this app,\n    // any client side route becomes a server side route!\n    // These invalid server side routings cause 404 errors.\n    // To workaround these errors, we can use GitHub 404.html redirection\n    // to pass the client side routes to this app by using query string.\n    // After this app loads, it can use the query string to correctly redirect to\n    // a client side route!\n    console.log(window.location.search);\n    const routeMatches = /route=([^&]*)/.exec(window.location.search);\n    const queryMatches = /query=([^&]*)/.exec(window.location.search);\n    if (routeMatches !== null) {\n      const route = decodeURIComponent(routeMatches[1]);\n\n      let query = ''\n      if (queryMatches !== null) {\n        query = decodeURIComponent(queryMatches[1]);\n      }\n      return <Redirect to={route + query} />;\n    } else if (window.location.pathname === `${Globals.pwaUrl}/` || window.location.pathname === `${Globals.pwaUrl}`) {\n      return <Redirect to={`${Globals.pwaUrl}/eInvoice`} />;\n    }\n  }\n\n  render() {\n    return (\n      <IonApp>\n        <IonReactRouter>\n          <IonTabs>\n            <IonRouterOutlet animated={false}>\n              {/* The following route is for backward compatibility. */}\n              <Route path={`${Globals.pwaUrl}/:tab(eInvoice)`} render={(props: any) => <EInvoiceListPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/:tab(eInvoice)/:invNum/:invDate`} render={(props: any) => <DetailPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/:tab(WinningList)`} render={(props: any) => <WinningListPage {...props} />} exact={true} />\n              <Route path={`${Globals.pwaUrl}/settings`} render={(props: any) => <SettingsPage {...props} />} />\n              <Route path={`${Globals.pwaUrl}/`} render={() => { return this.routeByQueryString(); }} exact={true} />\n            </IonRouterOutlet>\n            <IonTabBar slot=\"bottom\">\n              <IonTabButton tab=\"eInvoice\" href={`${Globals.pwaUrl}/eInvoice`}>\n                <IonIcon icon={receipt} />\n              </IonTabButton>\n              <IonTabButton tab=\"WinningList\" href={`${Globals.pwaUrl}/WinningList`}>\n                <IonIcon icon={trophy} />\n              </IonTabButton>\n              <IonTabButton tab=\"settings\" href={`${Globals.pwaUrl}/settings`}>\n                <IonIcon icon={settings} />\n              </IonTabButton>\n            </IonTabBar>\n          </IonTabs>\n        </IonReactRouter>\n        <IonAlert\n          cssClass='uiFont'\n          isOpen={this.state.showUpdateAlert}\n          backdropDismiss={false}\n          onDidPresent={(ev) => {\n            // Run SKIP_WAITING at onDidPresent event to avoid a race condition of\n            // an old page fetching old JS chunks with a new service worker!\n            this.registrationNew?.installing?.postMessage({ type: 'SKIP_WAITING' });\n            this.registrationNew?.waiting?.postMessage({ type: 'SKIP_WAITING' });\n          }}\n          header={'請重啟 app!'}\n          buttons={[\n            {\n              text: '關閉',\n              cssClass: 'primary uiFont',\n              handler: (value) => {\n                this.setState({\n                  showUpdateAlert: false,\n                });\n              },\n            }\n          ]}\n        />\n\n        <ShareTextModal\n          {...{\n            text: this.props.shareTextModal?.text,\n            showModal: this.props.shareTextModal?.show || false,\n            finish: () => {\n              store.dispatch({\n                type: \"TMP_SET_KEY_VAL\",\n                key: 'shareTextModal',\n                val: { show: false },\n              });\n            }, ...this.props\n          }}\n        />\n\n        <IonToast\n          cssClass='uiFont'\n          isOpen={this.state.showRestoreAppSettingsToast}\n          onDidDismiss={() => this.setState({ showRestoreAppSettingsToast: false })}\n          message={`已套用app連結中的設定，是否還原設定？`}\n          buttons={[\n            {\n              text: '取消',\n              role: 'cancel',\n              handler: () => this.setState({ showRestoreAppSettingsToast: false })\n            },\n            {\n              text: '還原',\n              handler: () => this.restoreAppSettings(),\n            },\n          ]}\n        />\n\n        <IonToast\n          cssClass='uiFont'\n          isOpen={this.state.showToast}\n          onDidDismiss={() => this.setState({ showToast: false })}\n          message={this.state.toastMessage}\n          duration={2000}\n        />\n      </IonApp>\n    );\n  }\n}\n\nconst mapStateToProps = (state: any /*, ownProps*/) => {\n  return {\n    shareTextModal: state.tmpSettings.shareTextModal,\n    settings: state.settings,\n    tmpSettings: state.tmpSettings,\n  }\n};\n\nconst AppOrig = connect(\n  mapStateToProps,\n)(_AppOrig);\n\n\nconst App = withRouter(_App);\n\nexport default App;\n","import { /*applyMiddleware,*/ createStore, Store } from \"redux\";\n\n//import { logger } from \"redux-logger\"\n//import thunk from \"redux-thunk\"\n//import promise from \"redux-promise-middleware\"\n\nimport reducer from \"./reducers\";\nimport Globals from \"../Globals\";\n\n//const middleware = applyMiddleware(promise(), thunk, logger)\n\nvar savedStore: Store;\n\nexport default function getSavedStore() {\n    var savedSettingsStr = localStorage.getItem(Globals.storeFile);\n    if (savedSettingsStr != null) {\n        savedStore = createStore(reducer, JSON.parse(savedSettingsStr));//, middleware)\n    }\n    else {\n        savedStore = createStore(reducer);//, middleware)\n    }\n\n    return savedStore;\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      /*\n      if(registration.waiting) {\n        const reg = registration.waiting;\n        reg.postMessage({ type: 'SKIP_WAITING' });\n        alert('Skip waiting.');\n      }*/\n\n      registration.onupdatefound = () => {\n        //alert('onupdatefound.');\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          console.log(`installingWorker stage changed: ${installingWorker.state}`);\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from \"react-router-dom\";\nimport App, {serviceWorkCallbacks} from './App';\nimport Globals from './Globals';\nimport * as serviceWorker from './serviceWorkerRegistration';\n\n// Enable at the very start for logging most messages.\nGlobals.enableAppLog();\n\nReactDOM.render(<BrowserRouter><App /></BrowserRouter>, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register({\n    onSuccess: (registration: ServiceWorkerRegistration) => { console.log('Precache app loaded!'); serviceWorkCallbacks.onSuccess(registration); },\n    onUpdate: (registration: ServiceWorkerRegistration) => { console.log('Found app updated!'); serviceWorkCallbacks.onUpdate(registration); },\n});\n","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t182,\n\t\t5\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t183,\n\t\t6\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t184,\n\t\t7\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t185,\n\t\t17\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t186,\n\t\t18\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t187,\n\t\t43\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t188,\n\t\t19\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t189,\n\t\t20\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t190,\n\t\t21\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t191,\n\t\t22\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t192,\n\t\t44\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t193,\n\t\t10\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t194,\n\t\t23\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t195,\n\t\t45\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t196,\n\t\t46\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t197,\n\t\t24\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t198,\n\t\t25\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t199,\n\t\t26\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t200,\n\t\t27\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t201,\n\t\t28\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t202,\n\t\t8\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t203,\n\t\t14\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t204,\n\t\t9\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t205,\n\t\t29\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t206,\n\t\t30\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t207,\n\t\t31\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t208,\n\t\t11\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t209,\n\t\t16\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t210,\n\t\t47\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t211,\n\t\t32\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t212,\n\t\t33\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t213,\n\t\t34\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t214,\n\t\t35\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t215,\n\t\t48\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t216,\n\t\t13\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t217,\n\t\t49\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t218,\n\t\t36\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t219,\n\t\t15\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t220,\n\t\t37\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t221,\n\t\t38\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t222,\n\t\t39\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t223,\n\t\t12\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t224,\n\t\t50\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 89;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./ion-icon.entry.js\": [\n\t\t225,\n\t\t57\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 91;\nmodule.exports = webpackAsyncContext;"],"sourceRoot":""}